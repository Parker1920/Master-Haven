const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Systems-BqwqVZTr.js","assets/vendor-three-B8lJlG1P.js","assets/vendor-react-D7IcbEIw.js","assets/vendor-ui-B9ygI19o.js","assets/Card-C4YgI0Ez.js","assets/Button-CI6OWZ-Z.js","assets/FormField-Bz54WX62.js","assets/DiscordTagBadge-Dk1S4C0Q.js","assets/usePersonalColor--X9CeE-n.js","assets/SearchableSelect-uNGq-GhX.js","assets/index-DywX51Id.js","assets/floating-ui.dom-DAbdHeWr.js","assets/XMarkIcon-COi7J9yy.js","assets/FunnelIcon-Do0aaPDo.js","assets/SystemDetail-DSa_-5zN.js","assets/GlyphDisplay-Bxlf3hKm.js","assets/economyTradeGoods-BcE93n58.js","assets/RegionDetail-gfip1xyi.js","assets/Wizard-4wB6irKl.js","assets/api-CLX3FGN7.js","assets/Settings-CgcefCDM.js","assets/Discoveries-CdBu3d82.js","assets/DiscoveryDetailModal-DXuYfdz7.js","assets/DiscoveryType-7WCnOv6Z.js","assets/DBStats-fDQyRvOJ.js","assets/PendingApprovals-4DM8W-LD.js","assets/ApiKeys-DXWTgrIJ.js","assets/PartnerManagement-bKHyblm1.js","assets/SubAdminManagement-C3g3S1xU.js","assets/ApprovalAudit-CPaOZO2v.js","assets/DateRangePicker-DRFStEbK.js","assets/parseISO-9NS-6p47.js","assets/DateRangePicker-B5U4kmJ6.css","assets/Analytics-9ihisxjg.js","assets/LeaderboardTable-DqzZUvMi.js","assets/StatCard-BS4rlja6.js","assets/PartnerAnalytics-vXTHdYnm.js","assets/Events-2dzS5t8M.js","assets/CsvImport-Bs2EGc4C.js","assets/DataRestrictions-_4AWwV8n.js","assets/WarRoom-Crp3fXXI.js","assets/WarRoomAdmin-DX1S6b5K.js"])))=>i.map(i=>d[i]);
import{j as e,_ as C,c as ne}from"./vendor-three-B8lJlG1P.js";import{b as t,L as o,R as le,c as v,N as F,d as oe,B as ce}from"./vendor-react-D7IcbEIw.js";import{a as L}from"./vendor-ui-B9ygI19o.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const p of c.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function a(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(l){if(l.ep)return;l.ep=!0;const c=a(l);fetch(l.href,c)}})();function ie({value:r,duration:s=1e3,prefix:a="",suffix:n=""}){const[l,c]=t.useState(0),p=t.useRef(0),m=t.useRef(null);t.useEffect(()=>{const x=typeof r=="number"?r:parseInt(r)||0,_=p.current,k=performance.now(),j=h=>{const i=h-k,u=Math.min(i/s,1),w=1-Math.pow(1-u,4),E=Math.floor(_+(x-_)*w);c(E),u<1?m.current=requestAnimationFrame(j):p.current=x};return m.current=requestAnimationFrame(j),()=>{m.current&&cancelAnimationFrame(m.current)}},[r,s]);const f=x=>x>=1e6?(x/1e6).toFixed(1)+"M":x>=1e3?(x/1e3).toFixed(1)+"K":x.toLocaleString();return e.jsxs("span",{className:"tabular-nums",children:[a,f(l),n]})}const H=["mousemove","mousedown","keydown","scroll","touchstart","click"],de=1e3,q=3600*1e3,Q=t.createContext({isDisconnected:!1,disconnect:()=>{},reconnect:()=>{},registerConnection:()=>{},unregisterConnection:()=>{},timeoutMs:q});function ue({children:r,timeout:s=q}){const[a,n]=t.useState(!1),l=t.useRef(new Map),c=t.useRef(null),p=t.useRef(null),m=t.useCallback(()=>{c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{n(!0),l.current.forEach((h,i)=>{try{h.cleanup?.()}catch(u){console.error(`Inactivity cleanup error for ${i}:`,u)}})},s)},[s]);t.useEffect(()=>{const h=()=>{p.current||(p.current=setTimeout(()=>{p.current=null,a||m()},de))};return H.forEach(i=>{window.addEventListener(i,h,{passive:!0})}),m(),()=>{H.forEach(i=>{window.removeEventListener(i,h)}),c.current&&clearTimeout(c.current),p.current&&clearTimeout(p.current)}},[a,m]);const f=t.useCallback(()=>{n(!1),m(),l.current.forEach((h,i)=>{try{h.restore?.()}catch(u){console.error(`Inactivity restore error for ${i}:`,u)}})},[m]),x=t.useCallback((h,i)=>{l.current.set(h,i)},[]),_=t.useCallback(h=>{l.current.delete(h)},[]),k=t.useCallback(()=>{n(!0),l.current.forEach((h,i)=>{try{h.cleanup?.()}catch(u){console.error(`Inactivity cleanup error for ${i}:`,u)}})},[]),j={isDisconnected:a,disconnect:k,reconnect:f,registerConnection:x,unregisterConnection:_,timeoutMs:s};return e.jsx(Q.Provider,{value:j,children:r})}function Z(){const r=t.useContext(Q);return r||{isDisconnected:!1,disconnect:()=>{},reconnect:()=>{},registerConnection:()=>{},unregisterConnection:()=>{},timeoutMs:0}}function me({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const G=t.forwardRef(me);function pe({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const xe=t.forwardRef(pe);function he({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ge=t.forwardRef(he);function fe({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"}))}const ye=t.forwardRef(fe);function be({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"}))}const ve=t.forwardRef(be);function je({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const we=t.forwardRef(je);function Ne({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const _e=t.forwardRef(Ne),Ce={system_submitted:{icon:"ðŸ“¤",color:"#00C2B3",label:"Submitted"},system_approved:{icon:"âœ…",color:"#4ade80",label:"Approved"},system_rejected:{icon:"âŒ",color:"#ef4444",label:"Rejected"},system_saved:{icon:"ðŸ’¾",color:"#00C2B3",label:"Saved"},system_deleted:{icon:"ðŸ—‘ï¸",color:"#ef4444",label:"Deleted"},system_edited:{icon:"âœï¸",color:"#f0ad4e",label:"Edited"},region_submitted:{icon:"ðŸ—ºï¸",color:"#9d4edd",label:"Region"},region_approved:{icon:"âœ…",color:"#4ade80",label:"Region"},region_rejected:{icon:"âŒ",color:"#ef4444",label:"Region"},discovery_added:{icon:"ðŸ”­",color:"#9d4edd",label:"Discovery"},map_generated:{icon:"ðŸŒŒ",color:"#00C2B3",label:"Map"},watcher_upload:{icon:"ðŸ‘ï¸",color:"#f0ad4e",label:"Watcher"}};function ke(){const[r,s]=t.useState(null),[a,n]=t.useState(null),[l,c]=t.useState({systems:0,planets:0,moons:0,regions:0,discoveries:0}),[p,m]=t.useState([]),[f,x]=t.useState({systems:0,regions:0}),[_,k]=t.useState([]),[j,h]=t.useState(!0),[i,u]=t.useState([]),[w,E]=t.useState(!1),d=t.useRef(null),A=t.useRef(null),{isDisconnected:b,registerConnection:y,unregisterConnection:P}=Z();t.useEffect(()=>{(async()=>{try{const[R,z,te,se,re]=await Promise.all([L.get("/api/stats").catch(()=>({data:null})),L.get("/api/db_stats").catch(()=>({data:{stats:{}}})),L.get("/api/stats/daily_changes").catch(()=>({data:{changes:{}}})),L.get("/api/regions/grouped?include_systems=false&limit=5").catch(()=>({data:{regions:[]}})),L.get("/api/systems/recent?limit=10").catch(()=>({data:{systems:[]}}))]);s(R.data),n(z.data?.stats||{}),c(te.data?.changes||{systems:0,planets:0,moons:0,regions:0,discoveries:0}),m(re.data?.systems||[]);const ae=(se.data?.regions||[]).map(M=>({name:M.display_name||M.custom_name||`Region (${M.region_x}, ${M.region_y}, ${M.region_z})`,count:M.system_count||0,hasCustomName:!!M.custom_name}));k(ae),h(!0)}catch(R){console.error("Failed to fetch dashboard data:",R),h(!1)}})(),L.get("/api/pending_systems/count").then(R=>{const z=R.data||{};x({systems:z.systems||0,regions:z.regions||0})}).catch(()=>{});const N=async()=>{try{const R=await L.get("/api/activity_logs?limit=50");u(R.data?.logs||[]),h(!0)}catch(R){console.error("Failed to fetch activity logs:",R)}};if(b)return;N();const W=()=>{A.current=setInterval(()=>{w||N()},6e4)};return W(),y("dashboard-activity-polling",{cleanup:()=>{A.current&&(clearInterval(A.current),A.current=null)},restore:()=>{N(),W()}}),()=>{P("dashboard-activity-polling"),A.current&&clearInterval(A.current)}},[w,b,y,P]),t.useEffect(()=>{!w&&d.current&&(d.current.scrollTop=d.current.scrollHeight)},[i,w]);const O=r?.total||a?.systems||0,T=a?.planets||0,Y=a?.moons||0,J=a?.populated_regions||a?.regions||r?.regions?.length||0,X=a?.discoveries||0,ee=g=>{const N=typeof g=="string"?new Date(g):g,R=Math.floor((new Date-N)/1e3);return R<60?"now":R<3600?`${Math.floor(R/60)}m ago`:R<86400?`${Math.floor(R/3600)}h ago`:`${Math.floor(R/86400)}d ago`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-2xl",style:{background:"linear-gradient(135deg, rgba(20, 27, 61, 0.95) 0%, rgba(10, 14, 39, 0.98) 100%)",border:"1px solid rgba(0, 194, 179, 0.2)",boxShadow:"0 0 60px rgba(0, 194, 179, 0.1), inset 0 1px 0 rgba(255,255,255,0.05)"},children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute -top-1/2 -left-1/4 w-1/2 h-full rounded-full opacity-20",style:{background:"radial-gradient(circle, rgba(0, 194, 179, 0.4) 0%, transparent 70%)"}}),e.jsx("div",{className:"absolute -bottom-1/2 -right-1/4 w-1/2 h-full rounded-full opacity-15",style:{background:"radial-gradient(circle, rgba(157, 78, 221, 0.4) 0%, transparent 70%)"}})]}),e.jsxs("div",{className:"relative p-6 lg:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold tracking-tight",style:{color:"var(--app-text)"},children:"Haven Control Room"}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium",style:{background:j?"rgba(0, 194, 179, 0.15)":"rgba(239, 68, 68, 0.15)",color:j?"#00C2B3":"#ef4444"},children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:`absolute inline-flex h-full w-full rounded-full opacity-75 ${j?"animate-ping":""}`,style:{background:j?"#00C2B3":"#ef4444"}}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2",style:{background:j?"#00C2B3":"#ef4444"}})]}),j?"Systems Online":"Connection Lost"]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4 lg:gap-6 mb-8",children:[{icon:"â­",label:"Systems",value:O,change:l.systems},{icon:"ðŸª",label:"Planets",value:T,change:l.planets},{icon:"ðŸŒ™",label:"Moons",value:Y,change:l.moons},{icon:"ðŸ—ºï¸",label:"Regions",value:J,change:l.regions},{icon:"ðŸ”­",label:"Discoveries",value:X,change:l.discoveries}].map((g,N)=>e.jsxs("div",{className:"text-center p-4 rounded-xl transition-all duration-300 hover:scale-105",style:{background:"rgba(255, 255, 255, 0.03)",border:"1px solid rgba(255, 255, 255, 0.06)"},children:[e.jsx("div",{className:"text-2xl mb-1",children:g.icon}),e.jsx("div",{className:"text-2xl lg:text-3xl font-bold",style:{color:"#00C2B3"},children:e.jsx(ie,{value:g.value,duration:1200})}),e.jsx("div",{className:"text-xs uppercase tracking-wider mt-1",style:{color:"var(--muted)"},children:g.label}),g.change>0?e.jsxs("div",{className:"text-xs mt-1",style:{color:"#4ade80"},children:["â–² +",g.change]}):e.jsx("div",{className:"text-xs mt-1",style:{color:"var(--muted)"},children:"â€” 24h"})]},N))}),e.jsx("div",{className:"flex flex-wrap gap-3 justify-center",children:e.jsxs(o,{to:"/wizard",className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl font-semibold text-white transition-all duration-300 hover:scale-105",style:{background:"linear-gradient(135deg, #00C2B3 0%, #00a89a 100%)",boxShadow:"0 4px 20px rgba(0, 194, 179, 0.4)"},children:[e.jsx(_e,{className:"w-5 h-5"}),"Add New System"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 rounded-xl overflow-hidden",style:{background:"var(--app-card)",border:"1px solid rgba(255, 255, 255, 0.06)"},children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",style:{borderColor:"rgba(255,255,255,0.06)"},children:[e.jsxs("h2",{className:"font-semibold flex items-center gap-2",style:{color:"#00C2B3"},children:[e.jsx(ve,{className:"w-5 h-5"}),"Galaxy Overview"]}),e.jsx("a",{href:"/map/latest",target:"_blank",rel:"noreferrer",className:"text-sm hover:underline",style:{color:"var(--muted)"},children:"Open Full Map â†’"})]}),e.jsxs("div",{className:"relative",style:{height:"320px"},children:[e.jsx("iframe",{src:"/map/latest?embed=true&hideUI=true",className:"w-full h-full border-0",title:"Galaxy Map Preview",style:{background:"#050810"}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:"linear-gradient(to bottom, transparent 80%, var(--app-card) 100%)",borderRadius:"0 0 12px 12px"}}),e.jsx("a",{href:"/map/latest",target:"_blank",rel:"noreferrer",className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity duration-300 cursor-pointer",style:{background:"rgba(0, 0, 0, 0.5)"},children:e.jsx("span",{className:"px-6 py-3 rounded-xl font-semibold text-white",style:{background:"rgba(0, 194, 179, 0.9)"},children:"Click to Open Full Map"})})]})]}),e.jsxs("div",{className:"rounded-xl p-5",style:{background:"var(--app-card)",border:"1px solid rgba(255, 255, 255, 0.06)"},children:[e.jsxs("h2",{className:"font-semibold mb-4 flex items-center gap-2",style:{color:"#f0ad4e"},children:[e.jsx(ye,{className:"w-5 h-5"}),"Pending Review"]}),f.systems+f.regions>0?e.jsxs("div",{className:"space-y-3",children:[f.systems>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg",style:{background:"rgba(240, 173, 78, 0.1)",border:"1px solid rgba(240, 173, 78, 0.2)"},children:[e.jsx("span",{className:"text-sm",children:"Systems awaiting approval"}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-bold",style:{background:"rgba(240, 173, 78, 0.2)",color:"#f0ad4e"},children:f.systems})]}),f.regions>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg",style:{background:"rgba(240, 173, 78, 0.1)",border:"1px solid rgba(240, 173, 78, 0.2)"},children:[e.jsx("span",{className:"text-sm",children:"Region names pending"}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-bold",style:{background:"rgba(240, 173, 78, 0.2)",color:"#f0ad4e"},children:f.regions})]}),e.jsx(o,{to:"/pending-approvals",className:"block w-full text-center py-2 rounded-lg text-sm font-medium transition-colors",style:{background:"rgba(240, 173, 78, 0.15)",color:"#f0ad4e"},children:"Review All â†’"})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-2",style:{color:"#4ade80"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--muted)"},children:"All caught up!"}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--muted)"},children:"No pending approvals"})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t",style:{borderColor:"rgba(255,255,255,0.06)"},children:[e.jsx("h3",{className:"text-xs uppercase tracking-wider mb-3",style:{color:"var(--muted)"},children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(o,{to:"/systems",className:"flex items-center gap-2 p-2 rounded-lg text-xs transition-colors hover:bg-white/5",children:[e.jsx(G,{className:"w-4 h-4",style:{color:"#00C2B3"}}),e.jsx("span",{children:"Systems"})]}),e.jsxs(o,{to:"/discoveries",className:"flex items-center gap-2 p-2 rounded-lg text-xs transition-colors hover:bg-white/5",children:[e.jsx(we,{className:"w-4 h-4",style:{color:"#9d4edd"}}),e.jsx("span",{children:"Discoveries"})]}),e.jsxs(o,{to:"/db_stats",className:"flex items-center gap-2 p-2 rounded-lg text-xs transition-colors hover:bg-white/5",children:[e.jsx(G,{className:"w-4 h-4",style:{color:"#00C2B3"}}),e.jsx("span",{children:"DB Stats"})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"rounded-xl p-5",style:{background:"var(--app-card)",border:"1px solid rgba(255, 255, 255, 0.06)"},children:[e.jsx("h2",{className:"font-semibold mb-4 flex items-center gap-2",style:{color:"#00C2B3"},children:"ðŸŒ Top Regions"}),e.jsx("div",{className:"space-y-2",children:_.length>0?_.map((g,N)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg",style:{background:"rgba(255, 255, 255, 0.02)"},children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 flex items-center justify-center rounded text-xs font-bold",style:{background:N===0?"rgba(255, 215, 0, 0.2)":N===1?"rgba(192, 192, 192, 0.2)":N===2?"rgba(205, 127, 50, 0.2)":"rgba(255,255,255,0.05)",color:N===0?"#ffd700":N===1?"#c0c0c0":N===2?"#cd7f32":"var(--muted)"},children:N+1}),e.jsx("span",{className:"text-sm truncate max-w-[140px]",style:{color:g.hasCustomName?"#9d4edd":"var(--muted)"},children:g.name})]}),e.jsxs("span",{className:"text-xs px-2 py-1 rounded",style:{background:"rgba(0, 194, 179, 0.1)",color:"#00C2B3"},children:[g.count," sys"]})]},N)):e.jsx("p",{className:"text-sm text-center py-4",style:{color:"var(--muted)"},children:"No regions yet"})})]}),e.jsxs("div",{className:"rounded-xl p-5",style:{background:"var(--app-card)",border:"1px solid rgba(255, 255, 255, 0.06)"},children:[e.jsxs("h2",{className:"font-semibold mb-4 flex items-center gap-2",style:{color:"#9d4edd"},children:[e.jsx(ge,{className:"w-5 h-5"}),"Recent Activity"]}),e.jsx("div",{className:"space-y-2",children:p.length>0?p.slice(0,6).map((g,N)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 rounded-lg",style:{background:"rgba(255, 255, 255, 0.02)"},children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0",style:{background:"#00C2B3"}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm truncate",children:g.name}),e.jsxs("p",{className:"text-xs",style:{color:"var(--muted)"},children:[g.galaxy||"Euclid"," â€¢ ",g.planets?.length||0," planets"]})]})]},g.id||N)):e.jsx("p",{className:"text-sm text-center py-4",style:{color:"var(--muted)"},children:"No recent activity"})}),e.jsx(o,{to:"/systems",className:"block text-center text-sm mt-3 pt-3 border-t",style:{borderColor:"rgba(255,255,255,0.06)",color:"var(--muted)"},children:"View All Systems â†’"})]}),e.jsxs("div",{className:"rounded-xl overflow-hidden flex flex-col self-start",style:{background:"var(--app-card)",border:"1px solid rgba(255, 255, 255, 0.06)",height:"290px"},children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b flex-shrink-0",style:{borderColor:"rgba(255,255,255,0.06)"},children:[e.jsxs("h2",{className:"font-semibold text-sm flex items-center gap-2",children:["ðŸ“‹ Activity Log",!w&&e.jsx("span",{className:"w-2 h-2 rounded-full animate-pulse",style:{background:"#4ade80"}})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>E(!w),className:"px-2 py-1 rounded text-xs transition-colors",style:{background:w?"rgba(239, 68, 68, 0.2)":"rgba(255,255,255,0.05)",color:w?"#ef4444":"var(--app-text)"},children:w?"â¸ Paused":"â–¶ Live"})})]}),e.jsx("div",{ref:d,className:"p-3 overflow-y-auto text-xs flex-1",style:{background:"rgba(0,0,0,0.2)"},children:i.length>0?[...i].reverse().map(g=>{const N=Ce[g.event_type]||{icon:"ðŸ“",color:"var(--muted)"};return e.jsxs("div",{className:"py-1.5 flex items-start gap-2 border-b border-white/5 last:border-0",children:[e.jsx("span",{className:"flex-shrink-0",children:N.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"truncate",style:{color:N.color},children:g.message}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",style:{color:"var(--muted)"},children:[e.jsx("span",{children:ee(g.timestamp)}),g.user_name&&e.jsxs("span",{children:["â€¢ ",g.user_name]})]})]})]},g.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",style:{color:"var(--muted)"},children:[e.jsx("span",{className:"text-2xl mb-2",children:"ðŸ“‹"}),e.jsx("p",{children:"No activity yet..."}),e.jsx("p",{className:"text-xs mt-1",children:"Activity will appear here as it happens"})]})})]})]})]})}function Ae({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{fillRule:"evenodd",d:"M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z",clipRule:"evenodd"}))}const Re=t.forwardRef(Ae);function Ee({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{fillRule:"evenodd",d:"M9 4.5a.75.75 0 0 1 .721.544l.813 2.846a3.75 3.75 0 0 0 2.576 2.576l2.846.813a.75.75 0 0 1 0 1.442l-2.846.813a3.75 3.75 0 0 0-2.576 2.576l-.813 2.846a.75.75 0 0 1-1.442 0l-.813-2.846a3.75 3.75 0 0 0-2.576-2.576l-2.846-.813a.75.75 0 0 1 0-1.442l2.846-.813A3.75 3.75 0 0 0 7.466 7.89l.813-2.846A.75.75 0 0 1 9 4.5ZM18 1.5a.75.75 0 0 1 .728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 0 1 0 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 0 1-1.456 0l-.258-1.036a2.625 2.625 0 0 0-1.91-1.91l-1.036-.258a.75.75 0 0 1 0-1.456l1.036-.258a2.625 2.625 0 0 0 1.91-1.91l.258-1.036A.75.75 0 0 1 18 1.5ZM16.5 15a.75.75 0 0 1 .712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 0 1 0 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 0 1-1.422 0l-.395-1.183a1.5 1.5 0 0 0-.948-.948l-1.183-.395a.75.75 0 0 1 0-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0 1 16.5 15Z",clipRule:"evenodd"}))}const Se=t.forwardRef(Ee);function Le({title:r,titleId:s,...a},n){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),r?t.createElement("title",{id:s},r):null,t.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const Pe=t.forwardRef(Le);function Oe({title:r,children:s,onClose:a,isOpen:n=!0}){return n?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-40 p-2 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"p-4 sm:p-6 rounded shadow w-full max-w-[95vw] sm:max-w-xl md:max-w-2xl lg:max-w-3xl my-2 sm:my-4 max-h-[95vh] sm:max-h-[90vh] flex flex-col",style:{backgroundColor:"var(--app-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 flex-shrink-0 gap-2",children:[e.jsx("div",{className:"font-semibold text-base sm:text-lg flex-1 min-w-0 truncate",children:r}),e.jsx("button",{onClick:a,className:"px-3 py-1.5 sm:px-2 sm:py-1 rounded text-sm flex-shrink-0",style:{backgroundColor:"var(--app-accent-3)",color:"#fff"},children:"Close"})]}),e.jsx("div",{className:"overflow-y-auto flex-1 -mx-4 px-4 sm:-mx-6 sm:px-6",children:s})]})}):null}const S={APPROVALS:"approvals",SETTINGS:"settings",CSV_IMPORT:"csv_import",BATCH_APPROVALS:"batch_approvals",WAR_ROOM:"war_room"},I=t.createContext({isAdmin:!1,isSuperAdmin:!1,isPartner:!1,isSubAdmin:!1,isHavenSubAdmin:!1,isCorrespondent:!1,user:null,loading:!0,login:async()=>{},logout:async()=>{},canAccess:()=>!1,refreshAuth:async()=>{}});function Te({children:r}){const[s,a]=t.useState(null),[n,l]=t.useState(!0);async function c(){try{const d=await(await fetch("/api/admin/status",{credentials:"include"})).json();d.logged_in?a({type:d.user_type,username:d.username,discordTag:d.discord_tag,displayName:d.display_name,enabledFeatures:d.enabled_features||[],accountId:d.account_id,parentDisplayName:d.parent_display_name,isHavenSubAdmin:d.is_haven_sub_admin||!1}):a(null)}catch(E){console.error("Auth check failed:",E),a(null)}finally{l(!1)}}t.useEffect(()=>{c()},[]);const p=!!s,m=s?.type==="super_admin",f=s?.type==="partner",x=s?.type==="sub_admin",_=s?.isHavenSubAdmin||!1,k=s?.type==="correspondent",j=t.useCallback(E=>{if(!s)return!1;if(m)return!0;const d=s.enabledFeatures||[];return d.includes("all")?!0:d.includes(E)},[s,m]),h=t.useCallback(async(E,d)=>{const A=await fetch("/api/admin/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:E,password:d})});if(!A.ok){const y=await A.json().catch(()=>({}));throw new Error(y.detail||"Login failed")}const b=await A.json();return a({type:b.user_type,username:b.username,discordTag:b.discord_tag,displayName:b.display_name,enabledFeatures:b.enabled_features||[],accountId:b.account_id,parentDisplayName:b.parent_display_name,isHavenSubAdmin:b.is_haven_sub_admin||!1}),b},[]),i=t.useCallback(async()=>{await fetch("/api/admin/logout",{method:"POST",credentials:"include"}),a(null)},[]),u=t.useCallback(async()=>{await c()},[]),w=t.useMemo(()=>({isAdmin:p,isSuperAdmin:m,isPartner:f,isSubAdmin:x,isHavenSubAdmin:_,isCorrespondent:k,user:s,loading:n,login:h,logout:i,canAccess:j,refreshAuth:u}),[p,m,f,x,_,k,s,n,h,i,j,u]);return e.jsx(I.Provider,{value:w,children:r})}function Me({open:r,onClose:s}){const[a,n]=t.useState(""),[l,c]=t.useState(""),[p,m]=t.useState(""),[f,x]=t.useState(!1),[_,k]=t.useState("admin"),j=t.useContext(I);if(!r)return null;async function h(u){u?.preventDefault(),m(""),x(!0);try{if(_==="correspondent"){const w=await L.post("/api/warroom/correspondents/login",{username:a,password:l});await j.refreshAuth(),n(""),c(""),s()}else await j.login(a,l),n(""),c(""),s()}catch(w){const E=w.response?.data?.detail||w.message||"Login failed";m(E)}finally{x(!1)}}function i(u){u.key==="Enter"&&h()}return e.jsx(Oe,{title:"Login",onClose:s,children:e.jsx("form",{onSubmit:h,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("button",{type:"button",onClick:()=>k("admin"),className:`flex-1 py-2 rounded text-sm font-medium transition-colors ${_==="admin"?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"Admin / Partner"}),e.jsx("button",{type:"button",onClick:()=>k("correspondent"),className:`flex-1 py-2 rounded text-sm font-medium transition-colors ${_==="correspondent"?"bg-red-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"War Correspondent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Username"}),e.jsx("input",{value:a,onChange:u=>n(u.target.value),onKeyDown:i,type:"text",className:"w-full p-2 border rounded bg-gray-700 text-white placeholder-gray-400",placeholder:"Enter username",autoFocus:!0,disabled:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Password"}),e.jsx("input",{value:l,onChange:u=>c(u.target.value),onKeyDown:i,type:"password",className:"w-full p-2 border rounded bg-gray-700 text-white placeholder-gray-400",placeholder:"Enter password",disabled:f})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{type:"submit",className:"btn flex-1",disabled:f||!a.trim()||!l,children:f?"Logging in...":"Login"}),e.jsx("button",{type:"button",className:"btn",onClick:s,disabled:f,children:"Cancel"})]}),p&&e.jsx("div",{className:"text-red-500 mt-2 text-sm",children:p})]})})})}function Ie(){const r=t.useContext(I),[s,a]=t.useState(!1),[n,l]=t.useState(!1),[c,p]=t.useState(0),[m,f]=t.useState(0),x=t.useRef(null),_=t.useRef(null),{isDisconnected:k,registerConnection:j,unregisterConnection:h}=Z(),{isAdmin:i,isSuperAdmin:u,isPartner:w,isSubAdmin:E,isCorrespondent:d,user:A,canAccess:b}=r;t.useEffect(()=>{if(!i){p(0);return}if(k)return;const P=async()=>{try{const T=await L.get("/api/pending_systems/count");p(T.data.count||0)}catch{}},O=()=>{x.current=setInterval(P,6e4)};return P(),O(),j("navbar-pending-polling",{cleanup:()=>{x.current&&(clearInterval(x.current),x.current=null)},restore:()=>{P(),O()}}),()=>{h("navbar-pending-polling"),x.current&&clearInterval(x.current)}},[i,k,j,h]),t.useEffect(()=>{if(!(b(S.WAR_ROOM)||d)){f(0);return}if(k)return;const O=async()=>{try{const T=await L.get("/api/warroom/conflicts/active");f(T.data?.length||0)}catch{}};return O(),_.current=setInterval(O,6e4),()=>{_.current&&clearInterval(_.current)}},[b,d,k]);const y=()=>l(!1);return e.jsxs("header",{className:"p-4 shadow",style:{background:"linear-gradient(90deg, var(--app-card), rgba(255,255,255,0.02))"},children:[e.jsxs("div",{className:"container mx-auto",role:"navigation","aria-label":"Main navigation",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{style:{background:"linear-gradient(135deg, var(--app-primary), var(--app-accent-2))"},className:"p-2 rounded-lg",children:e.jsx(Se,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-semibold",style:{color:"var(--app-text)"},children:"Haven Control Room"}),e.jsx("div",{className:"text-sm muted",style:{color:"var(--app-accent-3)"},children:i?e.jsxs("span",{children:[A?.displayName||A?.username,w&&A?.discordTag&&e.jsxs("span",{className:"ml-1 text-cyan-400",children:["(",A.discordTag,")"]}),u&&e.jsx("span",{className:"ml-1 text-yellow-400",children:"(Super Admin)"}),E&&e.jsx("span",{className:"ml-1 text-amber-400",children:"(Sub-Admin)"}),d&&e.jsx("span",{className:"ml-1 text-red-400",children:"(War Correspondent)"})]}):"Web"})]})]}),e.jsxs("nav",{className:"hidden lg:flex space-x-2","aria-label":"Primary",children:[e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/",children:"Dashboard"}),e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/systems",children:"Systems"}),e.jsx("a",{className:"px-3 py-1 hover:underline",href:"/map/latest",children:"Map"}),e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/create",children:"Create"}),b(S.SETTINGS)&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/settings",children:"Settings"}),e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/discoveries",children:"Discoveries"}),e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/db_stats",children:"DB Stats"}),b(S.APPROVALS)&&e.jsxs(o,{className:"px-3 py-1 hover:underline relative",to:"/pending-approvals",children:["Approvals",c>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:c>9?"9+":c})]}),u&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/api-keys",children:"API Keys"}),u&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/admin/partners",children:"Partners"}),u&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/admin/audit",children:"Audit Log"}),i&&!d&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/analytics",children:"Analytics"}),i&&!d&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/partner-analytics",children:"Partner Analytics"}),i&&!d&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/events",children:"Events"}),(b(S.WAR_ROOM)||d)&&e.jsxs(o,{className:"px-3 py-1 hover:underline text-red-400 font-bold relative",to:"/war-room",children:["War Room",m>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:m>9?"9+":m})]}),(u||w)&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/admin/sub-admins",children:"Sub-Admins"}),b(S.CSV_IMPORT)&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/csv-import",children:"CSV Import"}),i&&!d&&e.jsx(o,{className:"px-3 py-1 hover:underline",to:"/data-restrictions",children:"Restrictions"}),i?e.jsx("button",{className:"px-3 py-1 bg-red-500 text-white rounded",onClick:()=>r.logout(),children:"Logout"}):e.jsx("button",{className:"px-3 py-1 bg-blue-500 text-white rounded",onClick:()=>a(!0),children:"Login"})]}),e.jsx("button",{className:"lg:hidden p-2 text-white",onClick:()=>l(!n),"aria-label":"Toggle menu",children:n?e.jsx(Pe,{className:"w-6 h-6"}):e.jsx(Re,{className:"w-6 h-6"})})]}),n&&e.jsxs("nav",{className:"lg:hidden mt-4 flex flex-col space-y-2 pb-4","aria-label":"Mobile",children:[e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/",onClick:y,children:"Dashboard"}),e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/systems",onClick:y,children:"Systems"}),e.jsx("a",{className:"px-3 py-2 hover:bg-gray-700 rounded",href:"/map/latest",onClick:y,children:"Map"}),e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/create",onClick:y,children:"Create"}),b(S.SETTINGS)&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/settings",onClick:y,children:"Settings"}),e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/discoveries",onClick:y,children:"Discoveries"}),e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/db_stats",onClick:y,children:"DB Stats"}),b(S.APPROVALS)&&e.jsxs(o,{className:"px-3 py-2 hover:bg-gray-700 rounded flex justify-between items-center",to:"/pending-approvals",onClick:y,children:[e.jsx("span",{children:"Approvals"}),c>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:c>9?"9+":c})]}),u&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/api-keys",onClick:y,children:"API Keys"}),u&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/admin/partners",onClick:y,children:"Partners"}),u&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/admin/audit",onClick:y,children:"Audit Log"}),i&&!d&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/analytics",onClick:y,children:"Analytics"}),i&&!d&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/partner-analytics",onClick:y,children:"Partner Analytics"}),i&&!d&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/events",onClick:y,children:"Events"}),(b(S.WAR_ROOM)||d)&&e.jsxs(o,{className:"px-3 py-2 hover:bg-gray-700 rounded text-red-400 font-bold flex justify-between items-center",to:"/war-room",onClick:y,children:[e.jsx("span",{children:"War Room"}),m>0&&e.jsx("span",{className:"bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:m>9?"9+":m})]}),(u||w)&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/admin/sub-admins",onClick:y,children:"Sub-Admins"}),b(S.CSV_IMPORT)&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/csv-import",onClick:y,children:"CSV Import"}),i&&!d&&e.jsx(o,{className:"px-3 py-2 hover:bg-gray-700 rounded",to:"/data-restrictions",onClick:y,children:"Data Restrictions"}),e.jsxs("div",{className:"pt-2 border-t border-gray-700",children:[i&&e.jsxs("div",{className:"px-3 py-2 text-sm text-gray-400 mb-2",children:["Logged in as: ",A?.displayName||A?.username,w&&A?.discordTag&&e.jsxs("span",{className:"text-cyan-400",children:[" (",A.discordTag,")"]}),E&&e.jsx("span",{className:"text-amber-400",children:" (Sub-Admin)"}),d&&e.jsx("span",{className:"text-yellow-400",children:" (War Correspondent)"})]}),i?e.jsx("button",{className:"w-full px-3 py-2 bg-red-500 text-white rounded",onClick:()=>{r.logout(),y()},children:"Logout"}):e.jsx("button",{className:"w-full px-3 py-2 bg-blue-500 text-white rounded",onClick:()=>{a(!0),y()},children:"Login"})]})]})]}),e.jsx(Me,{open:s,onClose:()=>a(!1)})]})}function De(){const{isDisconnected:r,reconnect:s}=Z();return r?e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"p-8 rounded-xl shadow-2xl max-w-md w-full text-center",style:{backgroundColor:"var(--app-card)"},children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center",style:{background:"rgba(240, 173, 78, 0.2)"},children:e.jsx("span",{className:"text-3xl",children:"â¸"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",style:{color:"var(--app-text)"},children:"Session Paused"}),e.jsx("p",{className:"mb-6",style:{color:"var(--muted)"},children:"Your session was paused due to inactivity to save resources. Click below to resume all live connections."}),e.jsx("button",{onClick:s,className:"w-full py-3 px-6 rounded-lg font-semibold text-white transition-all duration-300 hover:scale-105",style:{background:"linear-gradient(135deg, var(--app-primary) 0%, #00a89a 100%)",boxShadow:"0 4px 20px rgba(0, 194, 179, 0.4)"},children:"Reconnect"})]})}):null}const Ve=t.lazy(()=>C(()=>import("./Systems-BqwqVZTr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),Be=t.lazy(()=>C(()=>import("./SystemDetail-DSa_-5zN.js"),__vite__mapDeps([14,1,2,3,4,5,15,16]))),Fe=t.lazy(()=>C(()=>import("./RegionDetail-gfip1xyi.js"),__vite__mapDeps([17,1,2,3,4,5,7,8,12,13]))),K=t.lazy(()=>C(()=>import("./Wizard-4wB6irKl.js"),__vite__mapDeps([18,1,2,3,4,5,19,9,10,11,16]))),ze=t.lazy(()=>C(()=>import("./Settings-CgcefCDM.js"),__vite__mapDeps([20,1,2,8,4,5,3]))),We=t.lazy(()=>C(()=>import("./Discoveries-CdBu3d82.js"),__vite__mapDeps([21,1,2,5,22,6,12,3]))),$e=t.lazy(()=>C(()=>import("./DiscoveryType-7WCnOv6Z.js"),__vite__mapDeps([23,1,2,5,22,6,12,13,3]))),Ze=t.lazy(()=>C(()=>import("./DBStats-fDQyRvOJ.js"),__vite__mapDeps([24,1,2,3]))),He=t.lazy(()=>C(()=>import("./PendingApprovals-4DM8W-LD.js"),__vite__mapDeps([25,1,2,3,4,5,15,8]))),Ge=t.lazy(()=>C(()=>import("./ApiKeys-DXWTgrIJ.js"),__vite__mapDeps([26,1,2,3,4,5,19]))),Ke=t.lazy(()=>C(()=>import("./PartnerManagement-bKHyblm1.js"),__vite__mapDeps([27,1,2,3,4,5]))),U=t.lazy(()=>C(()=>import("./SubAdminManagement-C3g3S1xU.js"),__vite__mapDeps([28,1,2,3,4,5]))),Ue=t.lazy(()=>C(()=>import("./ApprovalAudit-CPaOZO2v.js"),__vite__mapDeps([29,1,2,3,4,5,30,11,31,32]))),qe=t.lazy(()=>C(()=>import("./Analytics-9ihisxjg.js"),__vite__mapDeps([33,1,2,3,30,11,31,32,34,35,10]))),Qe=t.lazy(()=>C(()=>import("./PartnerAnalytics-vXTHdYnm.js"),__vite__mapDeps([36,1,2,3,30,11,31,32,34,35,10]))),Ye=t.lazy(()=>C(()=>import("./Events-2dzS5t8M.js"),__vite__mapDeps([37,1,2,3,34,31]))),Je=t.lazy(()=>C(()=>import("./CsvImport-Bs2EGc4C.js"),__vite__mapDeps([38,1,2,4,5,3]))),Xe=t.lazy(()=>C(()=>import("./DataRestrictions-_4AWwV8n.js"),__vite__mapDeps([39,1,2,4,5,3]))),et=t.lazy(()=>C(()=>import("./WarRoom-Crp3fXXI.js"),__vite__mapDeps([40,1,2,3]))),tt=t.lazy(()=>C(()=>import("./WarRoomAdmin-DX1S6b5K.js"),__vite__mapDeps([41,1,2,3])));function st(){return e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx("div",{className:"text-lg text-gray-400",children:"Loading..."})})}function V({children:r}){const s=t.useContext(I);return s.loading?e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx("div",{className:"text-lg text-gray-400",children:"Loading..."})}):s.isAdmin?r:e.jsx(F,{to:"/",replace:!0})}function B({children:r}){const s=t.useContext(I);return s.loading?e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx("div",{className:"text-lg text-gray-400",children:"Loading..."})}):s.isSuperAdmin?r:e.jsx(F,{to:"/",replace:!0})}function $({feature:r,children:s}){const a=t.useContext(I);return a.loading?e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx("div",{className:"text-lg text-gray-400",children:"Loading..."})}):a.isAdmin?a.canAccess(r)?s:e.jsx(F,{to:"/",replace:!0}):e.jsx(F,{to:"/",replace:!0})}function rt({children:r}){const s=t.useContext(I);return s.loading?e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx("div",{className:"text-lg text-gray-400",children:"Loading..."})}):s.user?.type==="correspondent"||s.isSuperAdmin||s.isAdmin&&s.canAccess(S.WAR_ROOM)?r:e.jsx(F,{to:"/",replace:!0})}function at(){return t.useEffect(()=>{fetch("/api/settings").then(r=>r.json()).then(r=>{if(!r)return;const s=r.theme||{};s.bg&&document.documentElement.style.setProperty("--app-bg",s.bg),s.text&&document.documentElement.style.setProperty("--app-text",s.text),s.card&&document.documentElement.style.setProperty("--app-card",s.card),s.primary&&document.documentElement.style.setProperty("--app-primary",s.primary)}).catch(()=>{})},[]),e.jsx(Te,{children:e.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--app-bg, #f8fafc)",color:"var(--app-text, #111827)"},children:[e.jsx(Ie,{}),e.jsx("main",{className:"container mx-auto p-6",children:e.jsx(t.Suspense,{fallback:e.jsx(st,{}),children:e.jsxs(le,{children:[e.jsx(v,{path:"/",element:e.jsx(ke,{})}),e.jsx(v,{path:"/systems",element:e.jsx(Ve,{})}),e.jsx(v,{path:"/systems/:id",element:e.jsx(Be,{})}),e.jsx(v,{path:"/regions/:rx/:ry/:rz",element:e.jsx(Fe,{})}),e.jsx(v,{path:"/create",element:e.jsx(K,{})}),e.jsx(v,{path:"/wizard",element:e.jsx(K,{})}),e.jsx(v,{path:"/discoveries",element:e.jsx(We,{})}),e.jsx(v,{path:"/discoveries/:type",element:e.jsx($e,{})}),e.jsx(v,{path:"/db_stats",element:e.jsx(Ze,{})}),e.jsx(v,{path:"/api-keys",element:e.jsx(B,{children:e.jsx(Ge,{})})}),e.jsx(v,{path:"/admin/partners",element:e.jsx(B,{children:e.jsx(Ke,{})})}),e.jsx(v,{path:"/admin/partners/:partnerId/sub-admins",element:e.jsx(B,{children:e.jsx(U,{})})}),e.jsx(v,{path:"/admin/audit",element:e.jsx(B,{children:e.jsx(Ue,{})})}),e.jsx(v,{path:"/analytics",element:e.jsx(V,{children:e.jsx(qe,{})})}),e.jsx(v,{path:"/partner-analytics",element:e.jsx(V,{children:e.jsx(Qe,{})})}),e.jsx(v,{path:"/events",element:e.jsx(V,{children:e.jsx(Ye,{})})}),e.jsx(v,{path:"/admin/sub-admins",element:e.jsx(V,{children:e.jsx(U,{})})}),e.jsx(v,{path:"/settings",element:e.jsx($,{feature:S.SETTINGS,children:e.jsx(ze,{})})}),e.jsx(v,{path:"/pending-approvals",element:e.jsx($,{feature:S.APPROVALS,children:e.jsx(He,{})})}),e.jsx(v,{path:"/csv-import",element:e.jsx($,{feature:S.CSV_IMPORT,children:e.jsx(Je,{})})}),e.jsx(v,{path:"/data-restrictions",element:e.jsx(V,{children:e.jsx(Xe,{})})}),e.jsx(v,{path:"/war-room",element:e.jsx(rt,{children:e.jsx(et,{})})}),e.jsx(v,{path:"/war-room/admin",element:e.jsx(B,{children:e.jsx(tt,{})})})]})})}),e.jsx(De,{})]})})}const nt=t.createContext(null);function D(r,s){try{document.documentElement.style.setProperty(r,s)}catch{}}function lt({children:r}){return t.useEffect(()=>{fetch("/api/settings").then(s=>s.json()).then(s=>{const a=s&&s.theme||s||{},n=a.colors||a||{},l=n.bg_dark||n.bg||a.bg||a.background,c=n.bg_card||n.card||a.card,p=n.accent_cyan||n.accent||a.primary||a.accent_cyan,m=n.text_primary||n.text||a.text,f=n.glow||a.glow;l&&D("--app-bg",l),m&&D("--app-text",m),c&&D("--app-card",c),p&&D("--app-primary",p),f&&D("--app-glow",f);const x=n&&Object.keys(n).length?n:a;Object.entries(x).forEach(([_,k])=>{if(!k)return;const j=`--app-${_.replace(/_/g,"-")}`;D(j,k)})}).catch(()=>{})},[]),e.jsx(nt.Provider,{value:null,children:r})}ne.createRoot(document.getElementById("root")).render(e.jsx(oe.StrictMode,{children:e.jsx(ce,{basename:"/haven-ui",children:e.jsx(lt,{children:e.jsx(ue,{timeout:36e5,children:e.jsx(at,{})})})})}));L.defaults.withCredentials=!0;export{I as A,ve as F,Oe as M,we as a,S as b};
