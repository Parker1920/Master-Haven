import{j as e}from"./vendor-three-B8lJlG1P.js";import{b as t,f as $,e as A,L as _}from"./vendor-react-D7IcbEIw.js";import{B as F}from"./Button-CI6OWZ-Z.js";import{D as q,a as I,b as H}from"./DiscoveryDetailModal-DXuYfdz7.js";import{a as D}from"./index-CIVSKp76.js";import{F as U}from"./XMarkIcon-COi7J9yy.js";import{F as W}from"./FunnelIcon-Do0aaPDo.js";import"./FormField-Bz54WX62.js";import"./vendor-ui-B9ygI19o.js";function Y({title:r,titleId:l,...u},m){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:m,"aria-labelledby":l},u),r?t.createElement("title",{id:l},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const Z=t.forwardRef(Y),L=[{value:"newest",label:"Newest First"},{value:"oldest",label:"Oldest First"},{value:"name",label:"Name A-Z"},{value:"views",label:"Most Viewed"}];function z({searchQuery:r,onSearchChange:l,sortBy:u,onSortChange:m,className:f=""}){const[h,j]=t.useState(!1),o=r.trim().length>0;return e.jsxs("div",{className:f,children:[e.jsxs("div",{className:"hidden sm:flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(D,{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:r,onChange:a=>l(a.target.value),placeholder:"Search discoveries...",className:"w-full pl-10 pr-4 py-2 rounded-lg bg-gray-800 border border-gray-700 text-white placeholder-gray-500 focus:border-cyan-500 focus:outline-none focus:ring-1 focus:ring-cyan-500"}),r&&e.jsx("button",{onClick:()=>l(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white",children:e.jsx(U,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Sort:"}),e.jsx("select",{value:u,onChange:a=>m(a.target.value),className:"px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-white focus:border-cyan-500 focus:outline-none",children:L.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})]}),e.jsxs("div",{className:"sm:hidden",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(D,{className:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:r,onChange:a=>l(a.target.value),placeholder:"Search...",className:"w-full pl-10 pr-4 py-2 rounded-lg bg-gray-800 border border-gray-700 text-white placeholder-gray-500 focus:border-cyan-500 focus:outline-none"})]}),e.jsxs("button",{onClick:()=>j(!h),className:`
              p-2 rounded-lg border transition-colors
              ${h?"bg-cyan-600 border-cyan-500 text-white":"bg-gray-800 border-gray-700 text-gray-400 hover:text-white"}
            `,children:[e.jsx(W,{className:"w-5 h-5"}),o&&e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 rounded-full bg-cyan-500"})]})]}),h&&e.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-gray-800/50 border border-gray-700 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-400 mb-1",children:"Sort by"}),e.jsx("select",{value:u,onChange:a=>m(a.target.value),className:"w-full px-3 py-2 rounded-lg bg-gray-800 border border-gray-700 text-white",children:L.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),o&&e.jsx("button",{onClick:()=>{l(""),m("newest")},className:"w-full py-2 text-sm text-gray-400 hover:text-white transition-colors",children:"Clear all filters"})]})]})]})}const C={fauna:{emoji:"ðŸ¦—",label:"Fauna",description:"Creatures and wildlife"},flora:{emoji:"ðŸŒ¿",label:"Flora",description:"Plants and vegetation"},mineral:{emoji:"ðŸ’Ž",label:"Mineral",description:"Minerals and resources"},ancient:{emoji:"ðŸ›ï¸",label:"Ancient",description:"Ancient structures and ruins"},history:{emoji:"ðŸ“œ",label:"History",description:"Historical findings"},bones:{emoji:"ðŸ¦´",label:"Bones",description:"Skeletal remains and fossils"},alien:{emoji:"ðŸ‘½",label:"Alien",description:"Alien encounters"},starship:{emoji:"ðŸš€",label:"Starship",description:"Ships and spacecraft"},multitool:{emoji:"âš™ï¸",label:"Multi-tool",description:"Multi-tools and gear"},lore:{emoji:"ðŸ“–",label:"Lore",description:"Stories and knowledge"},base:{emoji:"ðŸ ",label:"Custom Base",description:"Player-built bases"},other:{emoji:"ðŸ†•",label:"Other",description:"Miscellaneous discoveries"}};function G(r,l){const[u,m]=t.useState(r);return t.useEffect(()=>{const f=setTimeout(()=>{m(r)},l);return()=>clearTimeout(f)},[r,l]),u}function le(){const{type:r}=$(),[l,u]=A(),[m,f]=t.useState([]),[h,j]=t.useState(0),[o,a]=t.useState(0),[P,k]=t.useState(!0),[E,y]=t.useState(!1),[v,w]=t.useState(null),[g,T]=t.useState(l.get("q")||""),[b,O]=t.useState(l.get("sort")||"newest"),[i,x]=t.useState(parseInt(l.get("page")||"0",10)),N=G(g,300),p=C[r]||C.other,M=r in C;t.useEffect(()=>{const s=new URLSearchParams;g&&s.set("q",g),b!=="newest"&&s.set("sort",b),i>0&&s.set("page",i.toString()),u(s,{replace:!0})},[g,b,i,u]),t.useEffect(()=>{async function s(){k(!0);try{const n=new URLSearchParams;M&&n.set("type",r),N&&n.set("q",N),b&&n.set("sort",b),n.set("page",i.toString()),n.set("limit","24");const c=await fetch(`/api/discoveries/browse?${n}`);if(c.ok){const d=await c.json();f(d.discoveries||[]),j(d.total||0),a(d.pages||0)}}catch(n){console.error("Error fetching discoveries:",n)}finally{k(!1)}}s()},[r,N,b,i,M]);function R(s,n){f(c=>c.map(d=>d.id===s?{...d,is_featured:n}:d)),v?.id===s&&w(c=>({...c,is_featured:n}))}function V(){y(!1),x(0)}const B=t.useMemo(()=>{const s=[];let c=Math.max(0,i-Math.floor(2.5)),d=Math.min(o,c+5);d-c<5&&(c=Math.max(0,d-5));for(let S=c;S<d;S++)s.push(S);return s},[i,o]);return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(_,{to:"/discoveries",className:"inline-flex items-center gap-2 text-gray-400 hover:text-white mb-4 transition-colors",children:[e.jsx(Z,{className:"w-4 h-4"}),"Back to Discoveries"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-4xl",children:p.emoji}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:p.label}),e.jsx("p",{className:"text-gray-400",children:p.description})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-gray-400",children:[h.toLocaleString()," ",h===1?"discovery":"discoveries"]}),e.jsx(F,{onClick:()=>y(!0),children:"Submit Discovery"})]})]})]}),e.jsx(z,{searchQuery:g,onSearchChange:s=>{T(s),x(0)},sortBy:b,onSortChange:s=>{O(s),x(0)},className:"mb-6"}),P?e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsxs("div",{className:"text-lg text-gray-400",children:["Loading ",p.label.toLowerCase(),"..."]})}):m.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-64 text-center",children:[e.jsx("span",{className:"text-6xl mb-4 opacity-30",children:p.emoji}),e.jsxs("h3",{className:"text-xl font-semibold text-white mb-2",children:["No ",p.label.toLowerCase()," found"]}),e.jsx("p",{className:"text-gray-400 mb-4",children:g?`No results matching "${g}"`:`Be the first to submit a ${p.label.toLowerCase()} discovery!`}),e.jsx(F,{onClick:()=>y(!0),children:"Submit Discovery"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:m.map(s=>e.jsx(q,{discovery:s,onClick:()=>w(s)},s.id))}),o>1&&e.jsxs("div",{className:"mt-8 flex flex-wrap items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>x(0),disabled:i===0,className:"px-3 py-2 rounded-lg bg-gray-800 text-gray-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"First"}),e.jsx("button",{onClick:()=>x(s=>Math.max(0,s-1)),disabled:i===0,className:"px-3 py-2 rounded-lg bg-gray-800 text-gray-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Prev"}),B.map(s=>e.jsx("button",{onClick:()=>x(s),className:`
                    px-3 py-2 rounded-lg transition-colors
                    ${s===i?"bg-cyan-600 text-white":"bg-gray-800 text-gray-400 hover:text-white"}
                  `,children:s+1},s)),e.jsx("button",{onClick:()=>x(s=>Math.min(o-1,s+1)),disabled:i>=o-1,className:"px-3 py-2 rounded-lg bg-gray-800 text-gray-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}),e.jsx("button",{onClick:()=>x(o-1),disabled:i>=o-1,className:"px-3 py-2 rounded-lg bg-gray-800 text-gray-400 hover:text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Last"})]}),o>1&&e.jsxs("div",{className:"mt-4 text-center text-gray-500 text-sm",children:["Page ",i+1," of ",o," (",h.toLocaleString()," total)"]})]}),e.jsx(I,{isOpen:E,onClose:()=>y(!1),onSuccess:V}),e.jsx(H,{discovery:v,isOpen:!!v,onClose:()=>w(null),onFeatureToggle:R})]})}export{le as default};
