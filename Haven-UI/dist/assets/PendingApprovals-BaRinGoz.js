import{j as e}from"./vendor-three-B8lJlG1P.js";import{u as We,b as l}from"./vendor-react-D7IcbEIw.js";import{a as p}from"./vendor-ui-B9ygI19o.js";import{C as he}from"./Card-C4YgI0Ez.js";import{B as d}from"./Button-CI6OWZ-Z.js";import{A as Ye,b as Ve,M as v}from"./index-DfzvULyl.js";import{G as Ke}from"./GlyphDisplay-Bxlf3hKm.js";import{u as Qe}from"./usePersonalColor--X9CeE-n.js";function ns(){const Q=We(),pe=l.useContext(Ye),{isAdmin:le,isSuperAdmin:r,isHavenSubAdmin:M,user:_,loading:X,canAccess:ne}=pe||{},[ge,re]=l.useState(!0),[I,ue]=l.useState([]),[ie,je]=l.useState([]),[de,be]=l.useState([]),[t,w]=l.useState(null),[o,A]=l.useState(null),[i,$]=l.useState(null),[ye,R]=l.useState(!1),[fe,S]=l.useState(!1),[Ne,C]=l.useState(!1),[J,g]=l.useState(!1),[u,m]=l.useState(""),[c,j]=l.useState(!1),[E,ce]=l.useState(!1),[h,P]=l.useState(new Set),[k,L]=l.useState(!1),[ve,O]=l.useState(!1),[F,G]=l.useState(""),[_e,H]=l.useState(!1),[x,q]=l.useState(null),[we,Re]=l.useState([]),[f,Se]=l.useState("all"),{personalColor:oe}=Qe(),B=l.useCallback(s=>{if(!s)return"";let a=s.toLowerCase().trim();return a.includes("#")&&(a=a.split("#")[0]),a},[]),W=l.useMemo(()=>_?.username?B(_.username):"",[_?.username,B]),b=l.useCallback(s=>!_||r?!1:s.submitter_account_id&&s.submitter_account_type?_.type===s.submitter_account_type&&_.accountId===s.submitter_account_id:!!(W&&(s.submitted_by&&B(s.submitted_by)===W||s.personal_discord_username&&B(s.personal_discord_username)===W)),[_,r,W,B]),me=l.useMemo(()=>{const s=new Map;for(const a of I)s.set(a.id,b(a));return s},[I,b]),z=l.useCallback(s=>me.get(s.id)||!1,[me]);l.useEffect(()=>{r&&p.get("/api/discord_tags").then(s=>{Re(s.data.tags||[])}).catch(()=>{})},[r]),l.useEffect(()=>{X||(le?y():(alert("Admin authentication required"),Q("/systems")))},[X,le,Q]);async function y(){re(!0);try{const[s,a,n]=await Promise.all([p.get("/api/pending_systems"),p.get("/api/pending_region_names"),p.get("/api/pending_edits")]);ue(s.data.submissions||[]),je(a.data.pending||[]),be(n.data.requests||[])}catch(s){alert("Failed to load submissions: "+(s.response?.data?.detail||s.message))}finally{re(!1)}}async function Ce(s){try{const a=await p.get(`/api/pending_systems/${s.id}`);w(a.data),R(!0)}catch(a){alert("Failed to load submission details: "+(a.response?.data?.detail||a.message))}}async function ke(s,a){if(confirm(`Approve system "${a}"?

This will add it to the main database.`)){j(!0);try{const n=await p.post(`/api/approve_system/${s}`);alert(`System "${a}" approved successfully!

System ID: ${n.data.system_id}`),R(!1),w(null),y()}catch(n){alert("Approval failed: "+(n.response?.data?.detail||n.message))}finally{j(!1)}}}function Ae(s){w(s),m(""),g(!0)}async function $e(){if(!u.trim()){alert("Please provide a rejection reason");return}j(!0);try{await p.post(`/api/reject_system/${t.id}`,{reason:u}),alert(`System "${t.system_name}" rejected`),g(!1),R(!1),w(null),m(""),y()}catch(s){alert("Rejection failed: "+(s.response?.data?.detail||s.message))}finally{j(!1)}}function Ee(s){A(s),S(!0)}async function Pe(s){if(confirm(`Approve region name "${s.proposed_name}" for coordinates [${s.region_x}, ${s.region_y}, ${s.region_z}]?`)){j(!0);try{await p.post(`/api/pending_region_names/${s.id}/approve`),alert(`Region name "${s.proposed_name}" approved!`),S(!1),A(null),y()}catch(a){alert("Approval failed: "+(a.response?.data?.detail||a.message))}finally{j(!1)}}}async function De(){if(!u.trim()){alert("Please provide a rejection reason");return}j(!0);try{await p.post(`/api/pending_region_names/${o.id}/reject`,{reason:u}),alert(`Region name "${o.proposed_name}" rejected`),g(!1),S(!1),A(null),m(""),y()}catch(s){alert("Rejection failed: "+(s.response?.data?.detail||s.message))}finally{j(!1)}}function Me(s){$(s),C(!0)}async function Be(s){if(confirm(`Approve edit request for system "${s.system_name}"?

This will apply the partner's changes to the system.`)){j(!0);try{await p.post(`/api/pending_edits/${s.id}/approve`),alert(`Edit request approved! Changes have been applied to "${s.system_name}".`),C(!1),$(null),y()}catch(a){alert("Approval failed: "+(a.response?.data?.detail||a.message))}finally{j(!1)}}}async function ze(){if(!u.trim()){alert("Please provide a rejection reason");return}j(!0);try{await p.post(`/api/pending_edits/${i.id}/reject`,{notes:u}),alert("Edit request rejected"),g(!1),C(!1),$(null),m(""),y()}catch(s){alert("Rejection failed: "+(s.response?.data?.detail||s.message))}finally{j(!1)}}function Ue(s){P(a=>{const n=new Set(a);return n.has(s)?n.delete(s):n.add(s),n})}function Te(){const s=D.filter(a=>!z(a)).map(a=>a.id);P(new Set(s))}function Ie(){P(new Set)}function Le(){ce(!1),P(new Set)}async function Oe(){if(h.size!==0&&confirm(`Approve ${h.size} selected system(s)?

This will add them to the main database.`)){L(!0);try{const s=await p.post("/api/approve_systems/batch",{submission_ids:Array.from(h)});q(s.data),H(!0),P(new Set),y()}catch(s){alert("Batch approval failed: "+(s.response?.data?.detail||s.message))}finally{L(!1)}}}async function Fe(){if(!F.trim()){alert("Please provide a rejection reason");return}L(!0);try{const s=await p.post("/api/reject_systems/batch",{submission_ids:Array.from(h),reason:F});q(s.data),O(!1),G(""),H(!0),P(new Set),y()}catch(s){alert("Batch rejection failed: "+(s.response?.data?.detail||s.message))}finally{L(!1)}}const{filteredPendingSubmissions:D,filteredReviewedSubmissions:Z,pendingSubmissionsCount:Ge,reviewedSubmissionsCount:He}=l.useMemo(()=>{const s=[],a=[];let n=0,N=0;for(const T of I){const qe=T.status==="pending";let K=!0;r&&f!=="all"&&(f==="untagged"?K=!T.discord_tag:K=T.discord_tag===f),qe?(n++,K&&s.push(T)):(N++,K&&a.push(T))}return{filteredPendingSubmissions:s,filteredReviewedSubmissions:a,pendingSubmissionsCount:n,reviewedSubmissionsCount:N}},[I,r,f]),ee=l.useMemo(()=>ie.filter(s=>s.status==="pending"),[ie]),se=l.useMemo(()=>de.filter(s=>s.status==="pending"),[de]);function Y(s){const a={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${a[s]||"bg-gray-100 text-gray-800"}`,children:s.toUpperCase()})}const te=l.useMemo(()=>["bg-indigo-500 text-white","bg-violet-500 text-white","bg-fuchsia-500 text-white","bg-amber-500 text-black","bg-lime-500 text-black","bg-teal-500 text-white","bg-sky-500 text-white","bg-rose-500 text-white"],[]),ae=l.useMemo(()=>({Haven:"bg-cyan-500 text-white",IEA:"bg-green-500 text-white","B.E.S":"bg-orange-500 text-white",ARCH:"bg-purple-500 text-white",TBH:"bg-yellow-500 text-black",EVRN:"bg-pink-500 text-white"}),[]),V=l.useMemo(()=>new Map,[]),xe=l.useCallback(s=>{if(ae[s])return ae[s];if(V.has(s))return V.get(s);let a=0;for(let N=0;N<s.length;N++)a=s.charCodeAt(N)+((a<<5)-a);const n=te[Math.abs(a)%te.length];return V.set(s,n),n},[ae,te,V]),U=l.useCallback((s,a=null)=>{if(!s)return e.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-gray-500 text-white",children:"UNTAGGED"});if(s==="personal")return e.jsxs("span",{className:"px-2 py-1 rounded text-xs font-semibold text-white",style:{backgroundColor:oe},children:["PERSONAL",a?` - ${a}`:""]});const n=xe(s);return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${n}`,children:s})},[xe,oe]);return X||ge?e.jsx("div",{className:"p-4",children:e.jsx(he,{children:e.jsx("p",{children:"Loading submissions..."})})}):e.jsx("div",{className:"p-4",children:e.jsxs(he,{className:"max-w-6xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 mb-4",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:"Approvals Queue"}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3",children:[r&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-300 hidden sm:inline",children:"Filter:"}),e.jsxs("select",{className:"p-2 border rounded bg-gray-700 text-white text-sm flex-1 sm:flex-initial",value:f,onChange:s=>Se(s.target.value),children:[e.jsx("option",{value:"all",children:"All Communities"}),e.jsx("option",{value:"untagged",children:"Untagged Only"}),we.map(s=>e.jsxs("option",{value:s.tag,children:[s.name," (",s.tag,")"]},s.tag))]})]}),e.jsxs("div",{className:"flex gap-2",children:[ne&&ne(Ve.BATCH_APPROVALS)&&D.length>0&&e.jsx(d,{className:`text-sm ${E?"bg-amber-600 hover:bg-amber-700":"bg-indigo-600 hover:bg-indigo-700"}`,onClick:()=>E?Le():ce(!0),children:E?"Exit Batch":"Batch Mode"}),e.jsx(d,{className:"bg-gray-200 text-gray-800 text-sm",onClick:()=>Q("/systems"),children:"Back"})]})]})]}),ee.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-3",children:["Pending Region Names (",ee.length,")"]}),e.jsx("div",{className:"space-y-2",children:ee.map(s=>e.jsx("div",{className:"border rounded p-3 bg-purple-700 hover:bg-purple-600",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-lg",children:s.proposed_name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold bg-purple-200 text-purple-800",children:"REGION"}),Y(s.status),(r||M)&&s.discord_tag&&U(s.discord_tag,r?s.personal_discord_username:null)]}),e.jsxs("div",{className:"text-sm text-gray-300 mt-1",children:[e.jsxs("span",{children:["Coords: [",s.region_x,", ",s.region_y,", ",s.region_z,"]"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:["By: ",s.personal_discord_username||s.submitted_by||"Anonymous"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{children:new Date(s.submission_date).toLocaleDateString()})]})]}),e.jsx("button",{onClick:()=>Ee(s),className:"flex-shrink-0 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Review"})]})},`region-${s.id}`))})]}),r&&se.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-3",children:["Pending Edit Requests (",se.length,")"]}),e.jsx("div",{className:"space-y-2",children:se.map(s=>e.jsx("div",{className:"border rounded p-3 bg-orange-700 hover:bg-orange-600",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-lg",children:s.system_name||"Unknown System"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold bg-orange-200 text-orange-800",children:"EDIT"}),Y(s.status)]}),e.jsxs("div",{className:"text-sm text-gray-300 mt-1",children:[e.jsxs("span",{children:["Partner: ",s.partner_username||"Unknown"]}),s.partner_discord_tag&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"text-cyan-300",children:s.partner_discord_tag})]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{children:new Date(s.submitted_at).toLocaleDateString()})]}),s.explanation&&e.jsxs("div",{className:"text-sm text-yellow-300 mt-1 line-clamp-1",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",s.explanation]})]}),e.jsx("button",{onClick:()=>Me(s),className:"flex-shrink-0 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Review"})]})},`edit-${s.id}`))})]}),E&&e.jsx("div",{className:"mb-4 p-3 bg-indigo-900 border border-indigo-500 rounded",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4",children:[e.jsxs("span",{className:"text-white font-semibold text-sm",children:[h.size,"/",D.filter(s=>!z(s)).length," selected"]}),e.jsx("button",{onClick:Te,className:"text-sm text-indigo-300 hover:text-white underline",children:"Select All"}),h.size>0&&e.jsx("button",{onClick:Ie,className:"text-sm text-indigo-300 hover:text-white underline",children:"Clear"})]}),h.size>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{className:"bg-green-600 hover:bg-green-700 text-white text-sm flex-1 sm:flex-initial",onClick:Oe,disabled:k,children:k?"...":`Approve (${h.size})`}),e.jsx(d,{className:"bg-red-600 hover:bg-red-700 text-white text-sm flex-1 sm:flex-initial",onClick:()=>O(!0),disabled:k,children:k?"...":`Reject (${h.size})`})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-3",children:["Pending Systems (",D.length,r&&f!=="all"&&` of ${Ge}`,")"]}),D.length===0?e.jsx("div",{className:"text-gray-300 italic p-4 bg-cyan-700 rounded",children:f!=="all"?"No pending submissions match the selected filter":"No pending system submissions"}):e.jsx("div",{className:"space-y-2",children:D.map(s=>e.jsx("div",{className:`border rounded p-3 bg-cyan-700 hover:bg-cyan-600 ${E&&h.has(s.id)?"ring-2 ring-indigo-400":""}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[E&&e.jsx("div",{className:"flex-shrink-0 pt-1",children:e.jsx("input",{type:"checkbox",checked:h.has(s.id),onChange:()=>Ue(s.id),disabled:z(s),className:"w-5 h-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",title:z(s)?"Cannot select your own submission":""})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-lg",children:s.system_name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 mt-1",children:[Y(s.status),s.edit_system_id&&e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold bg-orange-500 text-white",children:"EDIT"}),!s.edit_system_id&&e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold bg-green-500 text-white",children:"NEW"}),z(s)&&e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold bg-amber-500 text-black",children:"YOURS"}),(r||M)&&s.discord_tag&&U(s.discord_tag,r?s.personal_discord_username:null),s.source==="companion_app"&&s.api_key_name&&e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-semibold bg-cyan-200 text-cyan-800",children:s.api_key_name})]}),e.jsxs("div",{className:"text-sm text-gray-300 mt-1",children:[e.jsxs("span",{children:["Galaxy: ",s.system_galaxy||"Euclid"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:s.system_data?.reality==="Permadeath"?"text-red-400":"text-green-400",children:s.system_data?.reality||"Normal"}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:["Submitted by: ",s.personal_discord_username||s.submitted_by||"Anonymous"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{children:["Date: ",new Date(s.submission_date).toLocaleString()]})]})]}),e.jsx("button",{onClick:()=>Ce(s),className:"flex-shrink-0 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Review"})]})},s.id))})]}),Z.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-3",children:["Recently Reviewed (",Z.length,r&&f!=="all"&&` of ${He}`,")"]}),e.jsx("div",{className:"space-y-2",children:Z.slice(0,10).map(s=>e.jsxs("div",{className:"border rounded p-3 bg-cyan-700",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:s.system_name}),Y(s.status),s.edit_system_id&&e.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-orange-500 text-white",children:"EDIT"}),!s.edit_system_id&&e.jsx("span",{className:"px-2 py-1 rounded text-xs font-semibold bg-green-500 text-white",children:"NEW"}),(r||M)&&s.discord_tag&&U(s.discord_tag,r?s.personal_discord_username:null)]}),e.jsxs("div",{className:"text-sm text-gray-300 mt-1",children:[e.jsxs("span",{children:["By: ",s.reviewed_by||"Unknown"]}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{children:s.review_date?new Date(s.review_date).toLocaleDateString():"Unknown"}),s.rejection_reason&&e.jsxs("div",{className:"text-red-300 mt-1 line-clamp-1",children:["Reason: ",s.rejection_reason]})]})]},s.id))})]}),ye&&t&&e.jsx(v,{title:`Review: ${t.system_name}`,onClose:()=>{R(!1),w(null)},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"System Information"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",t.system_data?.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Galaxy:"})," ",t.system_data?.galaxy||"Euclid"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reality:"})," ",e.jsx("span",{className:t.system_data?.reality==="Permadeath"?"text-red-400":"text-green-400",children:t.system_data?.reality||"Normal"})]}),t.glyph_code&&e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Glyph Code:"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx(Ke,{glyphCode:t.glyph_code,size:"medium"}),e.jsxs("span",{className:"font-mono text-xs text-gray-400",children:["(",t.glyph_code,")"]})]})]}),t.system_data?.region_x!==void 0&&t.system_data?.region_x!==null&&e.jsxs("p",{children:[e.jsx("strong",{children:"Region:"})," [",t.system_data.region_x,", ",t.system_data.region_y,", ",t.system_data.region_z,"]"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Coordinates:"})," (",t.system_data?.x||0,", ",t.system_data?.y||0,", ",t.system_data?.z||0,")"]}),(()=>{const s=t.system_data?.star_color||t.system_data?.star_type;return s&&s!=="Unknown"?e.jsxs("p",{children:[e.jsx("strong",{children:"Star Color:"})," ",e.jsx("span",{className:s==="Yellow"?"text-yellow-400":s==="Red"?"text-red-400":s==="Green"?"text-green-400":s==="Blue"?"text-blue-400":"",children:s})]}):null})(),t.system_data?.economy_type&&t.system_data.economy_type!=="Unknown"&&e.jsxs("p",{children:[e.jsx("strong",{children:"Economy:"})," ",t.system_data.economy_type," ",t.system_data.economy_level&&t.system_data.economy_level!=="Unknown"&&`(${t.system_data.economy_level})`]}),t.system_data?.conflict_level&&t.system_data.conflict_level!=="Unknown"&&e.jsxs("p",{children:[e.jsx("strong",{children:"Conflict:"})," ",e.jsx("span",{className:t.system_data.conflict_level==="High"?"text-red-400":t.system_data.conflict_level==="Low"?"text-green-400":"text-yellow-400",children:t.system_data.conflict_level})]}),t.system_data?.dominant_lifeform&&t.system_data.dominant_lifeform!=="Unknown"&&e.jsxs("p",{children:[e.jsx("strong",{children:"Dominant Lifeform:"})," ",t.system_data.dominant_lifeform]}),t.system_data?.stellar_classification&&e.jsxs("p",{children:[e.jsx("strong",{children:"Spectral Class:"})," ",e.jsx("span",{className:`font-mono ${(()=>{switch(t.system_data.stellar_classification[0]?.toUpperCase()){case"O":case"B":return"text-blue-300";case"F":case"G":return"text-yellow-300";case"K":case"M":return"text-red-400";case"E":return"text-green-400";case"X":case"Y":return"text-purple-400";default:return"text-gray-300"}})()}`,children:t.system_data.stellar_classification})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",t.system_data?.description||"None"]})]})]}),t.system_data?.planets&&t.system_data.planets.length>0&&e.jsxs("div",{className:"border-b pb-3",children:[e.jsxs("h4",{className:"font-semibold mb-2",children:["Planets (",t.system_data.planets.length,")"]}),e.jsx("div",{className:"space-y-3",children:t.system_data.planets.map((s,a)=>e.jsxs("div",{className:"text-sm bg-cyan-700 p-3 rounded",children:[e.jsx("div",{className:"flex items-start gap-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("p",{className:"font-semibold text-base",children:s.name}),s.planet_size&&s.planet_size!=="Unknown"&&e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${s.planet_size==="Large"?"bg-purple-600 text-white":s.planet_size==="Medium"?"bg-blue-600 text-white":s.planet_size==="Small"?"bg-green-600 text-white":"bg-gray-600 text-white"}`,children:s.planet_size})]}),(s.biome||s.biome_subtype)&&e.jsxs("div",{className:"mb-2 text-gray-300",children:[s.biome&&s.biome!=="Unknown"&&e.jsx("span",{className:`inline-block px-2 py-0.5 rounded text-xs font-medium mr-2 ${s.biome==="Lush"?"bg-green-700":s.biome==="Toxic"?"bg-yellow-700":s.biome==="Scorched"?"bg-orange-700":s.biome==="Radioactive"?"bg-lime-700":s.biome==="Frozen"?"bg-cyan-700":s.biome==="Barren"?"bg-stone-700":s.biome==="Dead"?"bg-gray-700":s.biome==="Weird"?"bg-purple-700":s.biome==="Swamp"?"bg-emerald-800":s.biome==="Lava"?"bg-red-700":"bg-gray-600"}`,children:s.biome}),s.biome_subtype&&s.biome_subtype!=="Unknown"&&s.biome_subtype!=="None"&&e.jsxs("span",{className:"text-xs text-gray-400",children:["(",s.biome_subtype,")"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-gray-300",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Sentinel:"})," ",s.sentinel||s.sentinels||"None"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Fauna:"})," ",s.fauna||"N/A",s.fauna_count>0&&` (${s.fauna_count})`]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Flora:"})," ",s.flora||"N/A",s.flora_count>0&&` (${s.flora_count})`]}),(s.climate||s.weather)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Weather:"})," ",s.climate||s.weather]}),s.has_water===1&&e.jsx("div",{children:e.jsx("span",{className:"text-cyan-300",children:"Has Water"})})]})]})}),(s.materials||s.resources&&s.resources.length>0)&&e.jsxs("div",{className:"mt-2 text-gray-300",children:[e.jsx("span",{className:"text-gray-400",children:"Resources:"})," ",s.materials||s.resources?.join(", ")]}),s.base_location&&e.jsxs("div",{className:"mt-1 text-gray-300",children:[e.jsx("span",{className:"text-gray-400",children:"Base Location:"})," ",s.base_location]}),s.description&&e.jsxs("div",{className:"mt-1 text-gray-300",children:[e.jsx("span",{className:"text-gray-400",children:"Description:"})," ",s.description]}),s.notes&&e.jsxs("div",{className:"mt-1 text-gray-300",children:[e.jsx("span",{className:"text-gray-400",children:"Notes:"})," ",s.notes]}),s.photo&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-400",children:"Photo:"})," ",e.jsx("span",{className:"text-cyan-300",children:s.photo})]}),s.moons&&s.moons.length>0&&e.jsxs("div",{className:"mt-2 ml-3 border-l-2 border-cyan-500 pl-3",children:[e.jsxs("p",{className:"text-gray-400 text-xs mb-1",children:["Moons (",s.moons.length,"):"]}),s.moons.map((n,N)=>e.jsxs("div",{className:"mb-2 text-xs",children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 mt-1 text-gray-300",children:[n.biome&&n.biome!=="Unknown"&&e.jsxs("div",{children:["Biome: ",n.biome]}),e.jsxs("div",{children:["Sentinel: ",n.sentinel||n.sentinels||"None"]}),e.jsxs("div",{children:["Fauna: ",n.fauna||"N/A"]}),e.jsxs("div",{children:["Flora: ",n.flora||"N/A"]}),(n.materials||n.resources&&n.resources.length>0)&&e.jsxs("div",{className:"col-span-2",children:["Resources: ",n.materials||n.resources?.join(", ")]})]})]},N))]})]},a))})]}),t.system_data?.moons&&t.system_data.moons.length>0&&e.jsxs("div",{className:"border-b pb-3 ml-4 border-l-2 border-gray-600 pl-4",children:[e.jsxs("h4",{className:"font-semibold mb-2 text-gray-300",children:[e.jsx("span",{className:"text-gray-500",children:"↳"})," System Moons (",t.system_data.moons.length,")"]}),e.jsx("div",{className:"space-y-2",children:t.system_data.moons.map((s,a)=>e.jsxs("div",{className:"text-sm bg-gray-700/70 p-3 rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("p",{className:"font-semibold",children:s.name}),e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-gray-500 text-white",children:"Moon"}),s.planet_size&&s.planet_size!=="Unknown"&&e.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium bg-gray-600",children:s.planet_size}),s.biome&&s.biome!=="Unknown"&&e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${s.biome==="Lush"?"bg-green-700":s.biome==="Toxic"?"bg-yellow-700":s.biome==="Scorched"?"bg-orange-700":s.biome==="Radioactive"?"bg-lime-700":s.biome==="Frozen"?"bg-cyan-700":s.biome==="Barren"?"bg-stone-700":s.biome==="Dead"?"bg-gray-700":s.biome==="Weird"?"bg-purple-700":"bg-gray-600"}`,children:s.biome})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 text-gray-300",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Sentinel:"})," ",s.sentinel||s.sentinels||"None"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Fauna:"})," ",s.fauna||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Flora:"})," ",s.flora||"N/A"]}),(s.climate||s.weather)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Weather:"})," ",s.climate||s.weather]})]}),(s.materials||s.resources&&s.resources.length>0)&&e.jsxs("div",{className:"mt-2 text-gray-300",children:[e.jsx("span",{className:"text-gray-400",children:"Resources:"})," ",s.materials||s.resources?.join(", ")]})]},a))})]}),t.system_data?.space_station&&e.jsxs("div",{className:"border-b pb-3",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Space Station"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",t.system_data.space_station.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Race:"})," ",t.system_data.space_station.race]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Position:"})," (",t.system_data.space_station.x,", ",t.system_data.space_station.y,", ",t.system_data.space_station.z,")"]})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Submitted by:"})," ",t.personal_discord_username||t.submitted_by||"Anonymous"]}),r&&t.personal_id&&e.jsxs("p",{children:[e.jsx("strong",{children:"Discord ID:"})," ",e.jsx("span",{className:"font-mono text-xs",children:t.personal_id})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Submission Date:"})," ",new Date(t.submission_date).toLocaleString()]}),t.source&&e.jsxs("p",{children:[e.jsx("strong",{children:"Source:"})," ",e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${t.source==="haven_extractor"?"bg-purple-600 text-white":t.source==="companion_app"?"bg-cyan-600 text-white":"bg-gray-600 text-white"}`,children:t.source==="haven_extractor"?"Haven Extractor":t.source})]}),t.api_key_name&&e.jsxs("p",{children:[e.jsx("strong",{children:"API Key:"})," ",t.api_key_name]}),r&&t.submitted_by_ip&&e.jsxs("p",{children:[e.jsx("strong",{children:"IP Address:"})," ",t.submitted_by_ip]}),(r||M)&&t.discord_tag&&e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Discord Community:"})," ",U(t.discord_tag,r?t.personal_discord_username:null)]})]}),t.status==="pending"&&e.jsxs("div",{className:"pt-3 border-t",children:[b(t)&&e.jsx("div",{className:"mb-3 p-3 bg-amber-900/50 border border-amber-500 rounded",children:e.jsxs("p",{className:"text-amber-300 text-sm",children:[e.jsx("strong",{children:"You submitted this system."})," Another admin must review and approve it to prevent conflicts of interest."]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(d,{className:"btn-primary bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm w-full sm:w-auto",onClick:()=>ke(t.id,t.system_name),disabled:c||b(t),title:b(t)?"You cannot approve your own submission":"",children:b(t)?"Cannot Self-Approve":c?"Approving...":"Approve"}),e.jsx(d,{className:"bg-red-600 text-white hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm w-full sm:w-auto",onClick:()=>{R(!1),Ae(t)},disabled:c||b(t),title:b(t)?"You cannot reject your own submission":"",children:b(t)?"Cannot Reject":"Reject"}),e.jsx(d,{className:"bg-gray-200 text-gray-800 text-sm w-full sm:w-auto",onClick:()=>{R(!1),w(null)},disabled:c,children:"Close"})]})]})]})}),J&&t&&e.jsx(v,{title:`Reject: ${t.system_name}`,onClose:()=>{g(!1),w(null),m("")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Please provide a reason for rejecting this submission. This will help the submitter understand why their system was not approved."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Rejection Reason"}),e.jsx("textarea",{className:"w-full border rounded p-2",rows:"4",value:u,onChange:s=>m(s.target.value),placeholder:"e.g., Duplicate system, incomplete information, violates naming guidelines..."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(d,{className:"bg-red-600 text-white hover:bg-red-700 text-sm w-full sm:w-auto",onClick:$e,disabled:c||!u.trim(),children:c?"Rejecting...":"Confirm Rejection"}),e.jsx(d,{className:"bg-gray-200 text-gray-800 text-sm w-full sm:w-auto",onClick:()=>{g(!1),m(""),R(!0)},disabled:c,children:"Cancel"})]})]})}),fe&&o&&e.jsx(v,{title:`Review Region Name: ${o.proposed_name}`,onClose:()=>{S(!1),A(null)},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Region Name Submission"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Proposed Name:"})," ",o.proposed_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Region Coordinates:"})," [",o.region_x,", ",o.region_y,", ",o.region_z,"]"]})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Submitted by:"})," ",o.personal_discord_username||o.submitted_by||"Anonymous"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Submission Date:"})," ",new Date(o.submission_date).toLocaleString()]}),r&&o.submitted_by_ip&&e.jsxs("p",{children:[e.jsx("strong",{children:"IP Address:"})," ",o.submitted_by_ip]}),(r||M)&&o.discord_tag&&e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Discord Community:"})," ",U(o.discord_tag,r?o.personal_discord_username:null)]})]}),o.status==="pending"&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-3 border-t",children:[e.jsx(d,{className:"btn-primary bg-green-600 hover:bg-green-700 text-sm w-full sm:w-auto",onClick:()=>Pe(o),disabled:c,children:c?"Approving...":"Approve"}),e.jsx(d,{className:"bg-red-600 text-white hover:bg-red-700 text-sm w-full sm:w-auto",onClick:()=>{S(!1),m(""),g(!0)},disabled:c,children:"Reject"}),e.jsx(d,{className:"bg-gray-200 text-gray-800 text-sm w-full sm:w-auto",onClick:()=>{S(!1),A(null)},disabled:c,children:"Close"})]})]})}),J&&o&&e.jsx(v,{title:`Reject: ${o.proposed_name}`,onClose:()=>{g(!1),A(null),m("")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Please provide a reason for rejecting this region name submission."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Rejection Reason"}),e.jsx("textarea",{className:"w-full border rounded p-2",rows:"4",value:u,onChange:s=>m(s.target.value),placeholder:"e.g., Name already in use, inappropriate name, etc..."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(d,{className:"bg-red-600 text-white hover:bg-red-700 text-sm w-full sm:w-auto",onClick:De,disabled:c||!u.trim(),children:c?"Rejecting...":"Confirm Rejection"}),e.jsx(d,{className:"bg-gray-200 text-gray-800 text-sm w-full sm:w-auto",onClick:()=>{g(!1),m(""),S(!0)},disabled:c,children:"Cancel"})]})]})}),Ne&&i&&e.jsx(v,{title:`Review Edit Request: ${i.system_name||"Unknown System"}`,onClose:()=>{C(!1),$(null)},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-b pb-3",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Submitted By"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Partner:"})," ",i.partner_username||"Unknown"]}),i.partner_discord_tag&&e.jsxs("p",{children:[e.jsx("strong",{children:"Discord Tag:"})," ",e.jsx("span",{className:"text-cyan-400",children:i.partner_discord_tag})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Submitted:"})," ",new Date(i.submitted_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"border-b pb-3",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Reason for Edit"}),e.jsx("div",{className:"bg-yellow-900/30 border border-yellow-700 rounded p-3 text-yellow-200",children:i.explanation||"No explanation provided"})]}),e.jsxs("div",{className:"border-b pb-3",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Proposed Changes"}),e.jsx("div",{className:"text-sm bg-gray-700 p-3 rounded max-h-64 overflow-y-auto",children:i.edit_data?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"System Name:"})," ",i.edit_data.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Galaxy:"})," ",i.edit_data.galaxy||"Euclid"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reality:"})," ",e.jsx("span",{className:i.edit_data.reality==="Permadeath"?"text-red-400":"text-green-400",children:i.edit_data.reality||"Normal"})]}),i.edit_data.description&&e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",i.edit_data.description]}),i.edit_data.planets&&e.jsxs("p",{children:[e.jsx("strong",{children:"Planets:"})," ",i.edit_data.planets.length]}),i.edit_data.discord_tag&&e.jsxs("p",{children:[e.jsx("strong",{children:"New Discord Tag:"})," ",e.jsx("span",{className:"text-cyan-400",children:i.edit_data.discord_tag})]})]}):e.jsx("p",{className:"text-gray-400",children:"No edit data available"})})]}),i.status==="pending"&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 pt-3 border-t",children:[e.jsx(d,{className:"btn-primary bg-green-600 hover:bg-green-700 text-sm w-full sm:w-auto",onClick:()=>Be(i),disabled:c,children:c?"Approving...":"Approve"}),e.jsx(d,{className:"bg-red-600 text-white hover:bg-red-700 text-sm w-full sm:w-auto",onClick:()=>{C(!1),m(""),g(!0)},disabled:c,children:"Reject"}),e.jsx(d,{className:"bg-gray-200 text-gray-800 text-sm w-full sm:w-auto",onClick:()=>{C(!1),$(null)},disabled:c,children:"Close"})]})]})}),J&&i&&e.jsx(v,{title:`Reject Edit: ${i.system_name||"Unknown System"}`,onClose:()=>{g(!1),$(null),m("")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Please provide a reason for rejecting this edit request. This will be visible to the partner."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Rejection Reason"}),e.jsx("textarea",{className:"w-full border rounded p-2",rows:"4",value:u,onChange:s=>m(s.target.value),placeholder:"e.g., Edit not appropriate, system belongs to another community, etc..."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(d,{className:"bg-red-600 text-white hover:bg-red-700 text-sm w-full sm:w-auto",onClick:ze,disabled:c||!u.trim(),children:c?"Rejecting...":"Confirm Rejection"}),e.jsx(d,{className:"bg-gray-200 text-gray-800 text-sm w-full sm:w-auto",onClick:()=>{g(!1),m(""),C(!0)},disabled:c,children:"Cancel"})]})]})}),ve&&e.jsx(v,{title:`Batch Reject ${h.size} Submission(s)`,onClose:()=>{O(!1),G("")},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:["Please provide a reason for rejecting these ",h.size," submission(s). This reason will be applied to all selected items."]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Rejection Reason"}),e.jsx("textarea",{className:"w-full border rounded p-2",rows:"4",value:F,onChange:s=>G(s.target.value),placeholder:"e.g., Duplicate systems, incomplete information, violates naming guidelines..."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(d,{className:"bg-red-600 text-white hover:bg-red-700 text-sm w-full sm:w-auto",onClick:Fe,disabled:k||!F.trim(),children:k?"Rejecting...":`Reject ${h.size}`}),e.jsx(d,{className:"bg-gray-200 text-gray-800 text-sm w-full sm:w-auto",onClick:()=>{O(!1),G("")},disabled:k,children:"Cancel"})]})]})}),_e&&x&&e.jsx(v,{title:"Batch Operation Results",onClose:()=>{H(!1),q(null)},children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"p-3 bg-green-900/50 border border-green-500 rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:x.summary?.approved||x.summary?.rejected||0}),e.jsx("div",{className:"text-sm text-green-300",children:x.results?.approved?"Approved":"Rejected"})]}),e.jsxs("div",{className:"p-3 bg-red-900/50 border border-red-500 rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-red-400",children:x.summary?.failed||0}),e.jsx("div",{className:"text-sm text-red-300",children:"Failed"})]}),e.jsxs("div",{className:"p-3 bg-amber-900/50 border border-amber-500 rounded",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-400",children:x.summary?.skipped||0}),e.jsx("div",{className:"text-sm text-amber-300",children:"Skipped"})]})]}),e.jsxs("div",{className:"max-h-64 overflow-y-auto space-y-3",children:[(x.results?.approved?.length>0||x.results?.rejected?.length>0)&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-green-400 mb-1",children:[x.results?.approved?"Approved":"Rejected",":"]}),e.jsx("ul",{className:"text-sm space-y-1",children:(x.results?.approved||x.results?.rejected||[]).map(s=>e.jsx("li",{className:"text-gray-300",children:s.name||`ID: ${s.id}`},s.id))})]}),x.results?.failed?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-red-400 mb-1",children:"Failed:"}),e.jsx("ul",{className:"text-sm space-y-1",children:x.results.failed.map(s=>e.jsxs("li",{className:"text-red-300",children:[s.name||`ID: ${s.id}`,": ",s.error]},s.id))})]}),x.results?.skipped?.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-amber-400 mb-1",children:"Skipped:"}),e.jsx("ul",{className:"text-sm space-y-1",children:x.results.skipped.map(s=>e.jsxs("li",{className:"text-amber-300",children:[s.name||`ID: ${s.id}`,": ",s.reason]},s.id))})]})]}),e.jsx("div",{className:"pt-3 border-t",children:e.jsx(d,{className:"bg-gray-200 text-gray-800",onClick:()=>{H(!1),q(null)},children:"Close"})})]})})]})})}export{ns as default};
