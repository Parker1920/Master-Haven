import{j as l}from"./vendor-three-B8lJlG1P.js";import{b as i,u as Ne}from"./vendor-react-D7IcbEIw.js";import{a as V}from"./vendor-ui-B9ygI19o.js";import{c as Y,D as De}from"./DateRangePicker-DRFStEbK.js";import{L as Ie}from"./LeaderboardTable-DqzZUvMi.js";import{c as A,p as W,a as Ce,i as we,s as k,b as Te,d as _e,e as pe,f as Re,g as ke,h as _,j as Le,k as Me,l as Ke,m as $e,n as ve,o as Be,q as Fe,r as We,t as Ge,u as Ve,v as ze,w as fe,x as Ue,y as Q,z as ge,R as Ze,S as qe,D as be,A as he,B,C as He,L as K,Z as ye,E as ee,F as Je,G as Xe,J as Ye,H as Qe,I as re,K as ne,M as U,N as J,P as ea,O as aa,Q as ta,T as ra,U as na,V as sa,W as ia,X as la,Y as oa,_ as ca,$ as da,a0 as ua,a1 as ma,a2 as F,a3 as se,a4 as pa,a5 as va,a6 as fa,a7 as ga,a8 as ba,a9 as ha,aa as ya,ab as xa,ac as Pa,ad as Aa,ae as ja,af as Oa,ag as Ea,ah as z,ai as Sa}from"./StatCard-BS4rlja6.js";import{A as Na}from"./index-CIVSKp76.js";import"./floating-ui.dom-DAbdHeWr.js";import"./parseISO-9NS-6p47.js";import"./index-DywX51Id.js";var xe=e=>e.graphicalItems.polarItems,Da=A([W,Ce],we),Z=A([xe,k,Da],Te),Ia=A([Z],_e),q=A([Ia,pe],Re),Ca=A([q,k,Z],ke);A([q,k,Z],(e,a,t)=>t.length>0?e.flatMap(r=>t.flatMap(n=>{var s,o=_(r,(s=a.dataKey)!==null&&s!==void 0?s:n.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):a?.dataKey!=null?e.map(r=>({value:_(r,a.dataKey),errorDomain:[]})):e.map(r=>({value:r,errorDomain:[]})));var ie=()=>{},wa=A([q,k,Z,Le,W],Me),Ta=A([k,Ke,$e,ie,wa,ie,ve,W],Be),Pe=A([k,ve,q,Ca,Fe,W,Ta],We),_a=A([Pe,k,Ge],Ve);A([k,Pe,_a,W],ze);function le(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function oe(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?le(Object(t),!0).forEach(function(r){Ra(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):le(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Ra(e,a,t){return(a=ka(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function ka(e){var a=La(e,"string");return typeof a=="symbol"?a:a+""}function La(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}var Ma=(e,a)=>a,ae=A([xe,Ma],(e,a)=>e.filter(t=>t.type==="pie").find(t=>t.id===a)),Ka=[],te=(e,a,t)=>t?.length===0?Ka:t,Ae=A([pe,ae,te],(e,a,t)=>{var{chartData:r}=e;if(a!=null){var n;if(a?.data!=null&&a.data.length>0?n=a.data:n=r,(!n||!n.length)&&t!=null&&(n=t.map(s=>oe(oe({},a.presentationProps),s.props))),n!=null)return n}}),$a=A([Ae,ae,te],(e,a,t)=>{if(!(e==null||a==null))return e.map((r,n)=>{var s,o=_(r,a.nameKey,a.name),c;return t!=null&&(s=t[n])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?c=t[n].props.fill:typeof r=="object"&&r!=null&&"fill"in r?c=r.fill:c=a.fill,{value:fe(o,a.dataKey),color:c,payload:r,type:a.legendType}})}),Ba=A([Ae,ae,te,Ue],(e,a,t,r)=>{if(!(a==null||e==null))return lt({offset:r,pieSettings:a,displayedData:e,cells:t})}),Fa=["key"],Wa=["onMouseEnter","onClick","onMouseLeave"],Ga=["id"],Va=["id"];function ce(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function g(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?ce(Object(t),!0).forEach(function(r){za(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ce(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function za(e,a,t){return(a=Ua(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function Ua(e){var a=Za(e,"string");return typeof a=="symbol"?a:a+""}function Za(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function R(){return R=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},R.apply(null,arguments)}function H(e,a){if(e==null)return{};var t,r,n=qa(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function qa(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}function Ha(e){var a=i.useMemo(()=>he(e.children,ee),[e.children]),t=B(r=>$a(r,e.id,a));return t==null?null:i.createElement(He,{legendPayload:t})}var Ja=i.memo(e=>{var{dataKey:a,nameKey:t,sectors:r,stroke:n,strokeWidth:s,fill:o,name:c,hide:f,tooltipType:d,id:x}=e,h={dataDefinedOnItem:r.map(u=>u.tooltipPayload),positions:r.map(u=>u.tooltipPosition),settings:{stroke:n,strokeWidth:s,fill:o,dataKey:a,nameKey:t,name:fe(c,a),hide:f,type:d,color:o,unit:"",graphicalItemId:x}};return i.createElement(Je,{tooltipEntrySettings:h})}),Xa=(e,a)=>e>a?"start":e<a?"end":"middle",Ya=(e,a,t)=>typeof a=="function"?F(a(e),t,t*.8):F(a,t,t*.8),Qa=(e,a,t)=>{var{top:r,left:n,width:s,height:o}=a,c=ma(s,o),f=n+F(e.cx,s,s/2),d=r+F(e.cy,o,o/2),x=F(e.innerRadius,c,0),h=Ya(t,e.outerRadius,c),u=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:f,cy:d,innerRadius:x,outerRadius:h,maxRadius:u}},et=(e,a)=>{var t=U(a-e),r=Math.min(Math.abs(a-e),360);return t*r};function at(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var tt=(e,a)=>{if(i.isValidElement(e))return i.cloneElement(e,a);if(typeof e=="function")return e(a);var t=Y("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:r}=a,n=H(a,Fa);return i.createElement(pa,R({},n,{type:"linear",className:t}))},rt=(e,a,t)=>{if(i.isValidElement(e))return i.cloneElement(e,a);var r=t;if(typeof e=="function"&&(r=e(a),i.isValidElement(r)))return r;var n=Y("recharts-pie-label-text",at(e));return i.createElement(va,R({},a,{alignmentBaseline:"middle",className:n}),r)};function nt(e){var{sectors:a,props:t,showLabels:r}=e,{label:n,labelLine:s,dataKey:o}=t;if(!r||!n||!a)return null;var c=ge(t),f=se(n),d=se(s),x=typeof n=="object"&&"offsetRadius"in n&&typeof n.offsetRadius=="number"&&n.offsetRadius||20,h=a.map((u,p)=>{var N=(u.startAngle+u.endAngle)/2,j=J(u.cx,u.cy,u.outerRadius+x,N),D=g(g(g(g({},c),u),{},{stroke:"none"},f),{},{index:p,textAnchor:Xa(j.x,u.cx)},j),v=g(g(g(g({},c),u),{},{fill:"none",stroke:u.fill},d),{},{index:p,points:[J(u.cx,u.cy,u.outerRadius,N),j],key:"line"});return i.createElement(ye,{zIndex:be.label,key:"label-".concat(u.startAngle,"-").concat(u.endAngle,"-").concat(u.midAngle,"-").concat(p)},i.createElement(K,null,s&&tt(s,v),rt(n,D,_(u,o))))});return i.createElement(K,{className:"recharts-pie-labels"},h)}function st(e){var{sectors:a,props:t,showLabels:r}=e,{label:n}=t;return typeof n=="object"&&n!=null&&"position"in n?i.createElement(ua,{label:n}):i.createElement(nt,{sectors:a,props:t,showLabels:r})}function it(e){var{sectors:a,activeShape:t,inactiveShape:r,allOtherPieProps:n,shape:s,id:o}=e,c=B(aa),f=B(ta),d=B(ra),{onMouseEnter:x,onClick:h,onMouseLeave:u}=n,p=H(n,Wa),N=na(x,n.dataKey,o),j=sa(u),D=ia(h,n.dataKey,o);return a==null||a.length===0?null:i.createElement(i.Fragment,null,a.map((v,O)=>{if(v?.startAngle===0&&v?.endAngle===0&&a.length!==1)return null;var S=d==null||d===o,I=String(O)===c&&(f==null||n.dataKey===f)&&S,C=c?r:null,y=t&&I?t:C,P=g(g({},v),{},{stroke:v.stroke,tabIndex:-1,[oa]:O,[la]:o});return i.createElement(K,R({key:"sector-".concat(v?.startAngle,"-").concat(v?.endAngle,"-").concat(v.midAngle,"-").concat(O),tabIndex:-1,className:"recharts-pie-sector"},ca(p,v,O),{onMouseEnter:N(v,O),onMouseLeave:j(v,O),onClick:D(v,O)}),i.createElement(da,R({option:s??y,index:O,shapeType:"sector",isActive:I},P)))}))}function lt(e){var a,{pieSettings:t,displayedData:r,cells:n,offset:s}=e,{cornerRadius:o,startAngle:c,endAngle:f,dataKey:d,nameKey:x,tooltipType:h}=t,u=Math.abs(t.minAngle),p=et(c,f),N=Math.abs(p),j=r.length<=1?0:(a=t.paddingAngle)!==null&&a!==void 0?a:0,D=r.filter(y=>_(y,d,0)!==0).length,v=(N>=360?D:D-1)*j,O=N-D*u-v,S=r.reduce((y,P)=>{var E=_(P,d,0);return y+(ne(E)?E:0)},0),I;if(S>0){var C;I=r.map((y,P)=>{var E=_(y,d,0),T=_(y,x,P),m=Qa(t,s,y),b=(ne(E)?E:0)/S,w,L=g(g({},y),n&&n[P]&&n[P].props);P?w=C.endAngle+U(p)*j*(E!==0?1:0):w=c;var M=w+U(p)*((E!==0?u:0)+b*O),G=(w+M)/2,$=(m.innerRadius+m.outerRadius)/2,Ee=[{name:T,value:E,payload:L,dataKey:d,type:h,graphicalItemId:t.id}],Se=J(m.cx,m.cy,$,G);return C=g(g(g(g({},t.presentationProps),{},{percent:b,cornerRadius:typeof o=="string"?parseFloat(o):o,name:T,tooltipPayload:Ee,midAngle:G,middleRadius:$,tooltipPosition:Se},L),m),{},{value:E,dataKey:d,startAngle:w,endAngle:M,payload:L,paddingAngle:U(p)*j}),C})}return I}function ot(e){var{showLabels:a,sectors:t,children:r}=e,n=i.useMemo(()=>!a||!t?[]:t.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[t,a]);return i.createElement(ea,{value:a?n:void 0},r)}function ct(e){var{props:a,previousSectorsRef:t,id:r}=e,{sectors:n,isAnimationActive:s,animationBegin:o,animationDuration:c,animationEasing:f,activeShape:d,inactiveShape:x,onAnimationStart:h,onAnimationEnd:u}=a,p=Xe(a,"recharts-pie-"),N=t.current,[j,D]=i.useState(!1),v=i.useCallback(()=>{typeof u=="function"&&u(),D(!1)},[u]),O=i.useCallback(()=>{typeof h=="function"&&h(),D(!0)},[h]);return i.createElement(ot,{showLabels:!j,sectors:n},i.createElement(Ye,{animationId:p,begin:o,duration:c,isActive:s,easing:f,onAnimationStart:O,onAnimationEnd:v,key:p},S=>{var I=[],C=n&&n[0],y=C?.startAngle;return n?.forEach((P,E)=>{var T=N&&N[E],m=E>0?Qe(P,"paddingAngle",0):0;if(T){var b=re(T.endAngle-T.startAngle,P.endAngle-P.startAngle,S),w=g(g({},P),{},{startAngle:y+m,endAngle:y+b+m});I.push(w),y=w.endAngle}else{var{endAngle:L,startAngle:M}=P,G=re(0,L-M,S),$=g(g({},P),{},{startAngle:y+m,endAngle:y+G+m});I.push($),y=$.endAngle}}),t.current=I,i.createElement(K,null,i.createElement(it,{sectors:I,activeShape:d,inactiveShape:x,allOtherPieProps:a,shape:a.shape,id:r}))}),i.createElement(st,{showLabels:!j,sectors:n,props:a}),a.children)}var dt={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:be.area};function ut(e){var{id:a}=e,t=H(e,Ga),{hide:r,className:n,rootTabIndex:s}=e,o=i.useMemo(()=>he(e.children,ee),[e.children]),c=B(x=>Ba(x,a,o)),f=i.useRef(null),d=Y("recharts-pie",n);return r||c==null?(f.current=null,i.createElement(K,{tabIndex:s,className:d})):i.createElement(ye,{zIndex:e.zIndex},i.createElement(Ja,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:c,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:a}),i.createElement(K,{tabIndex:s,className:d},i.createElement(ct,{props:g(g({},t),{},{sectors:c}),previousSectorsRef:f,id:a})))}function je(e){var a=Q(e,dt),{id:t}=a,r=H(a,Va),n=ge(r);return i.createElement(Ze,{id:t,type:"pie"},s=>i.createElement(i.Fragment,null,i.createElement(qe,{type:"pie",id:s,data:r.data,dataKey:r.dataKey,hide:r.hide,angleAxisId:0,radiusAxisId:0,name:r.name,nameKey:r.nameKey,tooltipType:r.tooltipType,legendType:r.legendType,fill:r.fill,cx:r.cx,cy:r.cy,startAngle:r.startAngle,endAngle:r.endAngle,paddingAngle:r.paddingAngle,minAngle:r.minAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius,cornerRadius:r.cornerRadius,presentationProps:n,maxRadius:a.maxRadius}),i.createElement(Ha,R({},r,{id:s})),i.createElement(ut,R({},r,{id:s}))))}je.displayName="Pie";function mt(e){var a=fa();return i.useEffect(()=>{a(ga(e))},[a,e]),null}var pt=["layout"];function X(){return X=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},X.apply(null,arguments)}function vt(e,a){if(e==null)return{};var t,r,n=ft(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function ft(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}var gt={top:5,right:5,bottom:5,left:5},Oe={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:gt,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},bt=i.forwardRef(function(a,t){var r,n=Q(a.categoricalChartProps,Oe),{layout:s}=n,o=vt(n,pt),{chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:d,tooltipPayloadSearcher:x}=a,h={chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:d,tooltipPayloadSearcher:x,eventEmitter:void 0};return i.createElement(ba,{preloadedState:{options:h},reduxStoreName:(r=n.id)!==null&&r!==void 0?r:c},i.createElement(ha,{chartData:n.data}),i.createElement(ya,{layout:s,margin:n.margin}),i.createElement(xa,{baseValue:void 0,accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className,reverseStackOrder:n.reverseStackOrder}),i.createElement(mt,{cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius}),i.createElement(Pa,X({},o,{ref:t})))});function de(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function ue(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?de(Object(t),!0).forEach(function(r){ht(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):de(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function ht(e,a,t){return(a=yt(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function yt(e){var a=xt(e,"string");return typeof a=="symbol"?a:a+""}function xt(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}var Pt=["item"],At=ue(ue({},Oe),{},{layout:"centric",startAngle:0,endAngle:360}),jt=i.forwardRef((e,a)=>{var t=Q(e,At);return i.createElement(bt,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Pt,tooltipPayloadSearcher:Aa,categoricalChartProps:t,ref:a})});const me=["#00C2B3","#9d4edd","#22c55e","#f59e0b","#ef4444","#3b82f6","#ec4899","#8b5cf6","#14b8a6","#f97316"],Ot=({active:e,payload:a})=>{if(!e||!a||!a.length)return null;const t=a[0].payload;return l.jsxs("div",{className:"rounded-lg p-3 shadow-xl",style:{background:"var(--app-card)",border:"1px solid rgba(255,255,255,0.1)"},children:[l.jsx("div",{className:"font-medium mb-1",style:{color:a[0].payload.fill},children:t.discord_tag||"Untagged"}),l.jsxs("div",{className:"text-sm",style:{color:"var(--app-text)"},children:[l.jsxs("div",{children:["Submissions: ",l.jsx("span",{className:"font-semibold",children:t.total_submissions})]}),l.jsxs("div",{children:["Submitters: ",l.jsx("span",{className:"font-semibold",children:t.unique_submitters})]}),l.jsxs("div",{children:["Approval Rate: ",l.jsxs("span",{className:"font-semibold",children:[t.approval_rate,"%"]})]})]})]})},Et=({cx:e,cy:a,midAngle:t,innerRadius:r,outerRadius:n,percent:s})=>{if(s<.05)return null;const o=Math.PI/180,c=r+(n-r)*.5,f=e+c*Math.cos(-t*o),d=a+c*Math.sin(-t*o);return l.jsx("text",{x:f,y:d,fill:"white",textAnchor:"middle",dominantBaseline:"central",style:{fontSize:"12px",fontWeight:600},children:`${(s*100).toFixed(0)}%`})};function St({data:e,loading:a=!1,height:t=300,showLegend:r=!0}){if(a)return l.jsx("div",{className:"flex items-center justify-center",style:{height:t},children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2",style:{borderColor:"var(--app-primary)"}})});if(!e||e.length===0)return l.jsx("div",{className:"flex items-center justify-center",style:{height:t,color:"var(--app-text)",opacity:.5},children:"No data available"});const n=e.map((s,o)=>({...s,fill:me[o%me.length]}));return l.jsx(ja,{width:"100%",height:t,children:l.jsxs(jt,{children:[l.jsx(je,{data:n,cx:"50%",cy:"50%",labelLine:!1,label:Et,outerRadius:t/3,innerRadius:t/6,dataKey:"total_submissions",nameKey:"discord_tag",paddingAngle:2,children:n.map((s,o)=>l.jsx(ee,{fill:s.fill},`cell-${o}`))}),l.jsx(Oa,{content:l.jsx(Ot,{})}),r&&l.jsx(Ea,{layout:"vertical",align:"right",verticalAlign:"middle",formatter:(s,o)=>l.jsx("span",{style:{color:"var(--app-text)",fontSize:"12px"},children:s||"Untagged"})})]})})}function Mt(){const e=Ne(),a=i.useContext(Na),{isSuperAdmin:t,isAdmin:r,user:n}=a,[s,o]=i.useState(!0),[c,f]=i.useState({startDate:null,endDate:null}),[d,x]=i.useState("month"),[h,u]=i.useState([]),[p,N]=i.useState({total_submissions:0,total_approved:0,total_rejected:0}),[j,D]=i.useState([]),[v,O]=i.useState([]),[S,I]=i.useState(""),[C,y]=i.useState([]);i.useEffect(()=>{!a.loading&&!r&&e("/")},[a.loading,r,e]),i.useEffect(()=>{r&&(async()=>{try{const b=await V.get("/api/discord_tags");y(b.data.tags||[])}catch(b){console.error("Failed to fetch discord tags:",b)}})()},[r]),i.useEffect(()=>{if(!r)return;(async()=>{o(!0);try{const b={};c.startDate&&c.endDate?(b.start_date=c.startDate.toISOString().split("T")[0],b.end_date=c.endDate.toISOString().split("T")[0]):d&&(b.period=d),S&&(b.discord_tag=S);const w=await V.get("/api/analytics/submission-leaderboard",{params:b,withCredentials:!0});u(w.data.leaderboard||[]),N(w.data.totals||{total_submissions:0,total_approved:0,total_rejected:0});const L=await V.get("/api/analytics/submissions-timeline",{params:{...b,granularity:d==="year"?"month":d==="month"?"week":"day"},withCredentials:!0});if(D(L.data.timeline||[]),t){const M=await V.get("/api/analytics/community-stats",{params:b,withCredentials:!0});O(M.data.communities||[])}}catch(b){console.error("Failed to fetch analytics:",b)}finally{o(!1)}})()},[c,d,S,t,r]);const P=({startDate:m,endDate:b})=>{f({startDate:m,endDate:b}),(m||b)&&x("")},E=m=>{x(m),f({startDate:null,endDate:null})};if(a.loading)return l.jsx("div",{className:"flex items-center justify-center min-h-64",children:l.jsx("div",{className:"text-lg text-gray-400",children:"Loading..."})});if(!r)return null;const T=i.useMemo(()=>p.total_submissions>0?(p.total_approved/p.total_submissions*100).toFixed(1):0,[p.total_submissions,p.total_approved]);return l.jsxs("div",{className:"min-h-screen p-6",style:{background:"var(--app-bg)"},children:[l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold",style:{color:"var(--app-text)"},children:"Analytics Dashboard"}),l.jsx("p",{className:"text-sm mt-1",style:{color:"var(--app-text)",opacity:.6},children:"Submission statistics and leaderboards"})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[l.jsx("div",{className:"flex items-center rounded-lg overflow-hidden",style:{background:"var(--app-card)",border:"1px solid rgba(255,255,255,0.1)"},children:["week","month","year","all"].map(m=>l.jsx("button",{onClick:()=>E(m),className:"px-3 py-2 text-sm font-medium transition-colors",style:{background:d===m?"var(--app-primary)":"transparent",color:d===m?"#000":"var(--app-text)"},children:m==="all"?"All Time":m.charAt(0).toUpperCase()+m.slice(1)},m))}),l.jsx(De,{startDate:c.startDate,endDate:c.endDate,onChange:P}),t&&l.jsxs("select",{value:S,onChange:m=>I(m.target.value),className:"px-3 py-2 rounded-lg text-sm",style:{background:"var(--app-card)",border:"1px solid rgba(255,255,255,0.1)",color:"var(--app-text)"},children:[l.jsx("option",{value:"",children:"All Communities"}),C.map(m=>l.jsx("option",{value:m.tag,children:m.name},m.tag))]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[l.jsx(z,{title:"Total Submissions",value:p.total_submissions.toLocaleString(),subtitle:d==="all"?"All time":`This ${d}`}),l.jsx(z,{title:"Approved",value:p.total_approved.toLocaleString(),subtitle:`${(p.total_approved/(p.total_submissions||1)*100).toFixed(1)}% of total`}),l.jsx(z,{title:"Rejected",value:p.total_rejected.toLocaleString(),subtitle:`${(p.total_rejected/(p.total_submissions||1)*100).toFixed(1)}% of total`}),l.jsx(z,{title:"Approval Rate",value:`${T}%`,subtitle:p.total_submissions>0?`${p.total_approved} approved`:"No submissions"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[l.jsxs("div",{className:"rounded-xl p-4",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[l.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--app-text)"},children:"Submissions Over Time"}),l.jsx(Sa,{data:j,loading:s,height:280})]}),t&&l.jsxs("div",{className:"rounded-xl p-4",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[l.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--app-text)"},children:"Community Breakdown"}),l.jsx(St,{data:v,loading:s,height:280})]}),!t&&l.jsxs("div",{className:"rounded-xl p-4",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[l.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--app-text)"},children:"Your Community Stats"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"p-4 rounded-lg",style:{background:"rgba(0, 194, 179, 0.1)"},children:[l.jsx("div",{className:"text-3xl font-bold",style:{color:"var(--app-primary)"},children:h.length}),l.jsx("div",{className:"text-sm mt-1",style:{color:"var(--app-text)",opacity:.7},children:"Active Submitters"})]}),l.jsxs("div",{className:"p-4 rounded-lg",style:{background:"rgba(34, 197, 94, 0.1)"},children:[l.jsxs("div",{className:"text-3xl font-bold",style:{color:"#22c55e"},children:[T,"%"]}),l.jsx("div",{className:"text-sm mt-1",style:{color:"var(--app-text)",opacity:.7},children:"Approval Rate"})]})]})]})]}),l.jsxs("div",{className:"rounded-xl p-4",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--app-text)"},children:"Submission Leaderboard"}),l.jsxs("div",{className:"text-sm",style:{color:"var(--app-text)",opacity:.6},children:["Top ",h.length," submitters"]})]}),l.jsx(Ie,{data:h,showCommunity:t&&!S,loading:s})]})]})}export{Mt as default};
