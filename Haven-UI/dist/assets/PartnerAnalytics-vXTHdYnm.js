import{j as i}from"./vendor-three-B8lJlG1P.js";import{b as l,u as Je}from"./vendor-react-D7IcbEIw.js";import{a as K}from"./vendor-ui-B9ygI19o.js";import{c as Qe,D as He}from"./DateRangePicker-DRFStEbK.js";import{L as ea}from"./LeaderboardTable-DqzZUvMi.js";import{aj as aa,ak as le,a2 as ce,al as de,am as ta,K as he,$ as ra,c as M,x as ia,an as sa,n as Y,ao as na,ap as R,aq as V,ar as F,as as U,at as Be,au as Ee,av as De,aw as la,ax as oa,ay as ge,az as ca,aA as be,aB as da,L as re,aC as ua,y as pa,D as ve,aD as Le,R as va,aE as ma,aF as xa,Z as me,w as _e,F as fa,aG as ha,aH as ga,A as ba,E as Te,B as ie,h as Me,aI as ya,aJ as ja,aK as ka,aL as ye,O as ze,U as Ke,V as Re,W as Fe,a3 as Aa,_ as $e,G as Ia,J as Pa,I as T,a0 as Sa,aM as wa,z as Oa,Q as Na,aN as Ca,M as je,aO as Ba,ad as Ea,ah as ae,ai as Da,ae as ke,aP as La,aQ as Ae,aR as Ie,aS as Pe,af as Se,ag as _a,aT as Ta}from"./StatCard-BS4rlja6.js";import{A as Ma}from"./index-CIVSKp76.js";import{f as za,p as Ka}from"./parseISO-9NS-6p47.js";import"./floating-ui.dom-DAbdHeWr.js";import"./index-DywX51Id.js";var we=(e,a,t)=>{var r=t??e;if(!le(r))return ce(r,a,0)},Ra=(e,a,t)=>{var r={},n=e.filter(aa),s=e.filter(c=>c.stackId==null),d=n.reduce((c,p)=>(c[p.stackId]||(c[p.stackId]=[]),c[p.stackId].push(p),c),r),u=Object.entries(d).map(c=>{var[p,f]=c,b=f.map(y=>y.dataKey),h=we(a,t,f[0].barSize);return{stackId:p,dataKeys:b,barSize:h}}),m=s.map(c=>{var p=[c.dataKey].filter(b=>b!=null),f=we(a,t,c.barSize);return{stackId:void 0,dataKeys:p,barSize:f}});return[...u,...m]};function Oe(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function te(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?Oe(Object(t),!0).forEach(function(r){Fa(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Fa(e,a,t){return(a=$a(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function $a(e){var a=Wa(e,"string");return typeof a=="symbol"?a:a+""}function Wa(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function Ga(e,a,t,r,n){var s=r.length;if(!(s<1)){var d=ce(e,t,0,!0),u,m=[];if(de(r[0].barSize)){var c=!1,p=t/s,f=r.reduce((v,x)=>v+(x.barSize||0),0);f+=(s-1)*d,f>=t&&(f-=(s-1)*d,d=0),f>=t&&p>0&&(c=!0,p*=.9,f=s*p);var b=(t-f)/2>>0,h={offset:b-d,size:0};u=r.reduce((v,x)=>{var S,j={stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:h.offset+h.size+d,size:c?p:(S=x.barSize)!==null&&S!==void 0?S:0}},P=[...v,j];return h=P[P.length-1].position,P},m)}else{var y=ce(a,t,0,!0);t-2*y-(s-1)*d<=0&&(d=0);var g=(t-2*y-(s-1)*d)/s;g>1&&(g>>=0);var I=de(n)?Math.min(g,n):g;u=r.reduce((v,x,S)=>[...v,{stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:y+(g+d)*S+(g-I)/2,size:I}}],m)}return u}}var Va=(e,a,t,r,n,s,d)=>{var u=le(d)?a:d,m=Ga(t,r,n!==s?n:s,e,u);return n!==s&&m!=null&&(m=m.map(c=>te(te({},c),{},{position:te(te({},c.position),{},{offset:c.position.offset-n/2})}))),m},Ua=(e,a)=>{var t=ta(a);if(!(!e||t==null||a==null)){var{stackId:r}=a;if(r!=null){var n=e[r];if(n){var{stackedData:s}=n;if(s)return s.find(d=>d.key===t)}}}};function Ya(e,a){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&de(e.zIndex)?e.zIndex:a}var Xa=["children"];function Za(e,a){if(e==null)return{};var t,r,n=qa(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function qa(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}var Ja={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Qa=l.createContext(Ja);function Ha(e){var{children:a}=e,t=Za(e,Xa);return l.createElement(Qa.Provider,{value:t},a)}var et="Invariant failed";function at(e,a){throw new Error(et)}function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},ue.apply(null,arguments)}function se(e){return l.createElement(ra,ue({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var tt=function(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(r,n)=>{if(he(a))return a;var s=he(r)||le(r);return s?a(r,n):(s||at(),t)}},rt=(e,a,t)=>t,it=(e,a)=>a,J=M([Ee,it],(e,a)=>e.filter(t=>t.type==="bar").find(t=>t.id===a)),st=M([J],e=>e?.maxBarSize),nt=(e,a,t,r)=>r,lt=M([Y,Ee,R,F,rt],(e,a,t,r,n)=>a.filter(s=>e==="horizontal"?s.xAxisId===t:s.yAxisId===r).filter(s=>s.isPanorama===n).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),ot=(e,a,t)=>{var r=Y(e),n=R(e,a),s=F(e,a);if(!(n==null||s==null))return r==="horizontal"?ge(e,"yAxis",s,t):ge(e,"xAxis",n,t)},ct=(e,a)=>{var t=Y(e),r=R(e,a),n=F(e,a);if(!(r==null||n==null))return t==="horizontal"?be(e,"xAxis",r):be(e,"yAxis",n)},dt=M([lt,ca,ct],Ra),ut=(e,a,t)=>{var r,n,s=J(e,a);if(s!=null){var d=R(e,a),u=F(e,a);if(!(d==null||u==null)){var m=Y(e),c=De(e),{maxBarSize:p}=s,f=le(p)?c:p,b,h;return m==="horizontal"?(b=V(e,"xAxis",d,t),h=U(e,"xAxis",d,t)):(b=V(e,"yAxis",u,t),h=U(e,"yAxis",u,t)),(r=(n=Be(b,h,!0))!==null&&n!==void 0?n:f)!==null&&r!==void 0?r:0}}},We=(e,a,t)=>{var r=Y(e),n=R(e,a),s=F(e,a);if(!(n==null||s==null)){var d,u;return r==="horizontal"?(d=V(e,"xAxis",n,t),u=U(e,"xAxis",n,t)):(d=V(e,"yAxis",s,t),u=U(e,"yAxis",s,t)),Be(d,u)}},pt=M([dt,De,la,oa,ut,We,st],Va),vt=(e,a,t)=>{var r=R(e,a);if(r!=null)return V(e,"xAxis",r,t)},mt=(e,a,t)=>{var r=F(e,a);if(r!=null)return V(e,"yAxis",r,t)},xt=(e,a,t)=>{var r=R(e,a);if(r!=null)return U(e,"xAxis",r,t)},ft=(e,a,t)=>{var r=F(e,a);if(r!=null)return U(e,"yAxis",r,t)},ht=M([pt,J],(e,a)=>{if(!(e==null||a==null)){var t=e.find(r=>r.stackId===a.stackId&&a.dataKey!=null&&r.dataKeys.includes(a.dataKey));if(t!=null)return t.position}}),gt=M([ot,J],Ua),bt=M([ia,sa,vt,mt,xt,ft,ht,Y,na,We,gt,J,nt],(e,a,t,r,n,s,d,u,m,c,p,f,b)=>{var{chartData:h,dataStartIndex:y,dataEndIndex:g}=m;if(!(f==null||d==null||a==null||u!=="horizontal"&&u!=="vertical"||t==null||r==null||n==null||s==null||c==null)){var{data:I}=f,v;if(I!=null&&I.length>0?v=I:v=h?.slice(y,g+1),v!=null)return Xt({layout:u,barSettings:f,pos:d,parentViewBox:a,bandSize:c,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:s,stackedData:p,displayedData:v,offset:e,cells:b,dataStartIndex:y})}}),yt=["index"];function pe(){return pe=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},pe.apply(null,arguments)}function jt(e,a){if(e==null)return{};var t,r,n=kt(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function kt(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}var Ge=l.createContext(void 0),At=e=>{var a=l.useContext(Ge);if(a!=null)return a.stackId;if(e!=null)return da(e)},It=(e,a)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(a),Pt=e=>{var a=l.useContext(Ge);if(a!=null){var{stackId:t}=a;return"url(#".concat(It(t,e),")")}},St=e=>{var{index:a}=e,t=jt(e,yt),r=Pt(a);return l.createElement(re,pe({className:"recharts-bar-stack-layer",clipPath:r},t))},wt=["onMouseEnter","onMouseLeave","onClick"],Ot=["value","background","tooltipPosition"],Nt=["id"],Ct=["onMouseEnter","onClick","onMouseLeave"];function _(){return _=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},_.apply(null,arguments)}function Ne(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function w(e){for(var a=1;a<arguments.length;a++){var t=arguments[a]!=null?arguments[a]:{};a%2?Ne(Object(t),!0).forEach(function(r){Bt(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ne(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Bt(e,a,t){return(a=Et(a))in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function Et(e){var a=Dt(e,"string");return typeof a=="symbol"?a:a+""}function Dt(e,a){if(typeof e!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,a);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(e)}function ne(e,a){if(e==null)return{};var t,r,n=Lt(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)===-1&&{}.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}function Lt(e,a){if(e==null)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(a.indexOf(r)!==-1)continue;t[r]=e[r]}return t}var _t=e=>{var{dataKey:a,name:t,fill:r,legendType:n,hide:s}=e;return[{inactive:s,dataKey:a,type:n,color:r,value:_e(t,a),payload:e}]},Tt=l.memo(e=>{var{dataKey:a,stroke:t,strokeWidth:r,fill:n,name:s,hide:d,unit:u,tooltipType:m,id:c}=e,p={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:t,strokeWidth:r,fill:n,dataKey:a,nameKey:void 0,name:_e(s,a),hide:d,type:m,color:n,unit:u,graphicalItemId:c}};return l.createElement(fa,{tooltipEntrySettings:p})});function Mt(e){var a=ie(ze),{data:t,dataKey:r,background:n,allOtherBarProps:s}=e,{onMouseEnter:d,onMouseLeave:u,onClick:m}=s,c=ne(s,wt),p=Ke(d,r,s.id),f=Re(u),b=Fe(m,r,s.id);if(!n||t==null)return null;var h=Aa(n);return l.createElement(me,{zIndex:Ya(n,ve.barBackground)},t.map((y,g)=>{var{value:I,background:v,tooltipPosition:x}=y,S=ne(y,Ot);if(!v)return null;var j=p(y,g),P=f(y,g),A=b(y,g),C=w(w(w(w(w({option:n,isActive:String(g)===a},S),{},{fill:"#eee"},v),h),$e(c,y,g)),{},{onMouseEnter:j,onMouseLeave:P,onClick:A,dataKey:r,index:g,className:"recharts-bar-background-rectangle"});return l.createElement(se,_({key:"background-bar-".concat(g)},C))}))}function zt(e){var{showLabels:a,children:t,rects:r}=e,n=r?.map(s=>{var d={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return w(w({},d),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:d,fill:s.fill})});return l.createElement(wa,{value:a?n:void 0},t)}function Kt(e){var{shape:a,activeBar:t,baseProps:r,entry:n,index:s,dataKey:d}=e,u=ie(ze),m=ie(Na),c=t&&String(s)===u&&(m==null||d===m),p=c?t:a;return c?l.createElement(me,{zIndex:ve.activeBar},l.createElement(se,_({},r,{name:String(r.name)},n,{isActive:c,option:p,index:s,dataKey:d}))):l.createElement(se,_({},r,{name:String(r.name)},n,{isActive:c,option:p,index:s,dataKey:d}))}function Rt(e){var{shape:a,baseProps:t,entry:r,index:n,dataKey:s}=e;return l.createElement(se,_({},t,{name:String(t.name)},r,{isActive:!1,option:a,index:n,dataKey:s}))}function Ft(e){var a,{data:t,props:r}=e,n=(a=Oa(r))!==null&&a!==void 0?a:{},{id:s}=n,d=ne(n,Nt),{shape:u,dataKey:m,activeBar:c}=r,{onMouseEnter:p,onClick:f,onMouseLeave:b}=r,h=ne(r,Ct),y=Ke(p,m,s),g=Re(b),I=Fe(f,m,s);return t?l.createElement(l.Fragment,null,t.map((v,x)=>l.createElement(St,_({index:x,key:"rectangle-".concat(v?.x,"-").concat(v?.y,"-").concat(v?.value,"-").concat(x),className:"recharts-bar-rectangle"},$e(h,v,x),{onMouseEnter:y(v,x),onMouseLeave:g(v,x),onClick:I(v,x)}),c?l.createElement(Kt,{shape:u,activeBar:c,baseProps:d,entry:v,index:x,dataKey:m}):l.createElement(Rt,{shape:u,baseProps:d,entry:v,index:x,dataKey:m})))):null}function $t(e){var{props:a,previousRectanglesRef:t}=e,{data:r,layout:n,isAnimationActive:s,animationBegin:d,animationDuration:u,animationEasing:m,onAnimationEnd:c,onAnimationStart:p}=a,f=t.current,b=Ia(a,"recharts-bar-"),[h,y]=l.useState(!1),g=!h,I=l.useCallback(()=>{typeof c=="function"&&c(),y(!1)},[c]),v=l.useCallback(()=>{typeof p=="function"&&p(),y(!0)},[p]);return l.createElement(zt,{showLabels:g,rects:r},l.createElement(Pa,{animationId:b,begin:d,duration:u,isActive:s,easing:m,onAnimationEnd:I,onAnimationStart:v,key:b},x=>{var S=x===1?r:r?.map((j,P)=>{var A=f&&f[P];if(A)return w(w({},j),{},{x:T(A.x,j.x,x),y:T(A.y,j.y,x),width:T(A.width,j.width,x),height:T(A.height,j.height,x)});if(n==="horizontal"){var C=T(0,j.height,x),E=T(j.stackedBarStart,j.y,x);return w(w({},j),{},{y:E,height:C})}var O=T(0,j.width,x),N=T(j.stackedBarStart,j.x,x);return w(w({},j),{},{width:O,x:N})});return x>0&&(t.current=S??null),S==null?null:l.createElement(re,null,l.createElement(Ft,{props:a,data:S}))}),l.createElement(Sa,{label:a.label}),a.children)}function Wt(e){var a=l.useRef(null);return l.createElement($t,{previousRectanglesRef:a,props:e})}var Ve=0,Gt=(e,a)=>{var t=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:t,errorVal:Me(e,a)}};class Vt extends l.PureComponent{render(){var{hide:a,data:t,dataKey:r,className:n,xAxisId:s,yAxisId:d,needClip:u,background:m,id:c}=this.props;if(a||t==null)return null;var p=Qe("recharts-bar",n),f=c;return l.createElement(re,{className:p,id:c},u&&l.createElement("defs",null,l.createElement(ya,{clipPathId:f,xAxisId:s,yAxisId:d})),l.createElement(re,{className:"recharts-bar-rectangles",clipPath:u?"url(#clipPath-".concat(f,")"):void 0},l.createElement(Mt,{data:t,dataKey:r,background:m,allOtherBarProps:this.props}),l.createElement(Wt,this.props)))}}var Ut={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:Ve,xAxisId:0,yAxisId:0,zIndex:ve.bar};function Yt(e){var{xAxisId:a,yAxisId:t,hide:r,legendType:n,minPointSize:s,activeBar:d,animationBegin:u,animationDuration:m,animationEasing:c,isAnimationActive:p}=e,{needClip:f}=ha(a,t),b=ga(),h=Le(),y=ba(e.children,Te),g=ie(x=>bt(x,e.id,h,y));if(b!=="vertical"&&b!=="horizontal")return null;var I,v=g?.[0];return v==null||v.height==null||v.width==null?I=0:I=b==="vertical"?v.height/2:v.width/2,l.createElement(Ha,{xAxisId:a,yAxisId:t,data:g,dataPointFormatter:Gt,errorBarOffset:I},l.createElement(Vt,_({},e,{layout:b,needClip:f,data:g,xAxisId:a,yAxisId:t,hide:r,legendType:n,minPointSize:s,activeBar:d,animationBegin:u,animationDuration:m,animationEasing:c,isAnimationActive:p})))}function Xt(e){var{layout:a,barSettings:{dataKey:t,minPointSize:r},pos:n,bandSize:s,xAxis:d,yAxis:u,xAxisTicks:m,yAxisTicks:c,stackedData:p,displayedData:f,offset:b,cells:h,parentViewBox:y,dataStartIndex:g}=e,I=a==="horizontal"?u:d,v=p?I.scale.domain():null,x=ja({numericAxis:I}),S=I.scale(x);return f.map((j,P)=>{var A,C,E,O,N,$;if(p){var Q=p[P+g];if(Q==null)return null;A=ka(Q,v)}else A=Me(j,t),Array.isArray(A)||(A=[x,A]);var D=tt(r,Ve)(A[1],P);if(a==="horizontal"){var X,[H,W]=[u.scale(A[0]),u.scale(A[1])];C=ye({axis:d,ticks:m,bandSize:s,offset:n.offset,entry:j,index:P}),E=(X=W??H)!==null&&X!==void 0?X:void 0,O=n.size;var Z=H-W;if(N=Ca(Z)?0:Z,$={x:C,y:b.top,width:O,height:b.height},Math.abs(D)>0&&Math.abs(N)<Math.abs(D)){var z=je(N||D)*(Math.abs(D)-Math.abs(N));E-=z,N+=z}}else{var[ee,B]=[d.scale(A[0]),d.scale(A[1])];if(C=ee,E=ye({axis:u,ticks:c,bandSize:s,offset:n.offset,entry:j,index:P}),O=B-ee,N=n.size,$={x:b.left,y:E,width:b.width,height:N},Math.abs(D)>0&&Math.abs(O)<Math.abs(D)){var G=je(O||D)*(Math.abs(D)-Math.abs(O));O+=G}}if(C==null||E==null||O==null||N==null)return null;var oe=w(w({},j),{},{stackedBarStart:S,x:C,y:E,width:O,height:N,value:p?A:A[1],payload:j,background:$,tooltipPosition:{x:C+O/2,y:E+N/2},parentViewBox:y},h&&h[P]&&h[P].props);return oe}).filter(Boolean)}function Zt(e){var a=pa(e,Ut),t=At(a.stackId),r=Le();return l.createElement(va,{id:a.id,type:"bar"},n=>l.createElement(l.Fragment,null,l.createElement(ma,{legendPayload:_t(a)}),l.createElement(Tt,{dataKey:a.dataKey,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.fill,name:a.name,hide:a.hide,unit:a.unit,tooltipType:a.tooltipType,id:n}),l.createElement(xa,{type:"bar",id:n,data:void 0,xAxisId:a.xAxisId,yAxisId:a.yAxisId,zAxisId:0,dataKey:a.dataKey,stackId:t,hide:a.hide,barSize:a.barSize,minPointSize:a.minPointSize,maxBarSize:a.maxBarSize,isPanorama:r}),l.createElement(me,{zIndex:a.zIndex},l.createElement(Yt,_({},a,{id:n})))))}var Ue=l.memo(Zt,ua);Ue.displayName="Bar";var qt=["axis","item"],Jt=l.forwardRef((e,a)=>l.createElement(Ba,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:qt,tooltipPayloadSearcher:Ea,categoricalChartProps:e,ref:a}));const q={fauna:{label:"Fauna",emoji:"ðŸ¦—",color:"#22c55e"},flora:{label:"Flora",emoji:"ðŸŒ¿",color:"#10b981"},mineral:{label:"Mineral",emoji:"ðŸ’Ž",color:"#6366f1"},ancient:{label:"Ancient",emoji:"ðŸ›ï¸",color:"#f59e0b"},history:{label:"History",emoji:"ðŸ“œ",color:"#eab308"},bones:{label:"Bones",emoji:"ðŸ¦´",color:"#a3a3a3"},alien:{label:"Alien",emoji:"ðŸ‘½",color:"#8b5cf6"},starship:{label:"Starship",emoji:"ðŸš€",color:"#3b82f6"},multitool:{label:"Multi-tool",emoji:"âš™ï¸",color:"#64748b"},lore:{label:"Lore",emoji:"ðŸ“–",color:"#d946ef"},base:{label:"Base",emoji:"ðŸ ",color:"#f97316"},other:{label:"Other",emoji:"ðŸ†•",color:"#737373"}},Ce=({active:e,payload:a,label:t})=>!e||!a||!a.length?null:i.jsxs("div",{className:"rounded-lg p-3 shadow-xl",style:{background:"var(--app-card)",border:"1px solid rgba(255,255,255,0.1)"},children:[i.jsx("div",{className:"text-xs font-medium mb-2",style:{color:"var(--app-text)"},children:t}),a.map((r,n)=>i.jsxs("div",{className:"flex items-center justify-between gap-4 text-sm",children:[i.jsxs("span",{style:{color:r.color},children:[r.name,":"]}),i.jsx("span",{className:"font-semibold",style:{color:"var(--app-text)"},children:r.value})]},n))]}),Qt={1:{bg:"rgba(255, 215, 0, 0.15)",border:"rgba(255, 215, 0, 0.3)",text:"#FFD700"},2:{bg:"rgba(192, 192, 192, 0.15)",border:"rgba(192, 192, 192, 0.3)",text:"#C0C0C0"},3:{bg:"rgba(205, 127, 50, 0.15)",border:"rgba(205, 127, 50, 0.3)",text:"#CD7F32"}};function cr(){const e=Je(),a=l.useContext(Ma),{isSuperAdmin:t,isAdmin:r,user:n}=a,[s,d]=l.useState(!0),[u,m]=l.useState({startDate:null,endDate:null}),[c,p]=l.useState("month"),[f,b]=l.useState([]),[h,y]=l.useState(""),[g,I]=l.useState(null),[v,x]=l.useState([]),[S,j]=l.useState({}),[P,A]=l.useState([]),[C,E]=l.useState({}),[O,N]=l.useState([]),[$,Q]=l.useState([]),[D,X]=l.useState([]);l.useEffect(()=>{!a.loading&&!r&&e("/")},[a.loading,r,e]),l.useEffect(()=>{t&&K.get("/api/discord_tags").then(o=>{b(o.data.tags||[])}).catch(()=>{})},[t]),l.useEffect(()=>{if(!r)return;(async()=>{d(!0);try{const k={};u.startDate&&u.endDate?(k.start_date=u.startDate.toISOString().split("T")[0],k.end_date=u.endDate.toISOString().split("T")[0]):c&&(k.period=c),h&&(k.discord_tag=h);const L={params:k,withCredentials:!0},[Ye,xe,fe,Xe,Ze,qe]=await Promise.all([K.get("/api/analytics/partner-overview",L),K.get("/api/analytics/submission-leaderboard",L),K.get("/api/analytics/discovery-leaderboard",L),K.get("/api/analytics/submissions-timeline",{params:{...k,granularity:c==="year"?"month":c==="month"?"week":"day"},withCredentials:!0}),K.get("/api/analytics/discovery-timeline",{params:{...k,granularity:c==="year"?"month":c==="month"?"week":"day"},withCredentials:!0}),K.get("/api/analytics/discovery-type-breakdown",L)]);I(Ye.data),x(xe.data.leaderboard||[]),j(xe.data.totals||{}),A(fe.data.leaderboard||[]),E(fe.data.totals||{}),N(Xe.data.timeline||[]),Q(Ze.data.timeline||[]),X(qe.data.breakdown||[])}catch(k){console.error("Failed to fetch partner analytics:",k)}finally{d(!1)}})()},[u,c,h,t,r]);const H=({startDate:o,endDate:k})=>{m({startDate:o,endDate:k}),(o||k)&&p("")},W=o=>{p(o),m({startDate:null,endDate:null})},Z=l.useMemo(()=>$.map(o=>({...o,displayDate:o.date.includes("W")||o.date.length===7?o.date:za(Ka(o.date),"MMM d")})),[$]),z=l.useMemo(()=>D.map(o=>({...o,label:q[o.type_slug]?.label||o.type_slug||"Other",emoji:q[o.type_slug]?.emoji||"",fill:q[o.type_slug]?.color||"#737373"})),[D]),ee=l.useMemo(()=>h?f.find(k=>k.tag===h)?.name||h:!t&&n?.discord_tag?n.discord_tag:"All Communities",[h,f,t,n]);if(a.loading)return i.jsx("div",{className:"flex items-center justify-center min-h-64",children:i.jsx("div",{className:"text-lg text-gray-400",children:"Loading..."})});if(!r)return null;const B=g?.submissions||{},G=g?.discoveries||{},oe=B.total>0?(B.approved/B.total*100).toFixed(1):0;return i.jsxs("div",{className:"min-h-screen p-6",style:{background:"var(--app-bg)"},children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold",style:{color:"var(--app-text)"},children:"Partner Analytics"}),i.jsxs("p",{className:"text-sm mt-1",style:{color:"var(--app-text)",opacity:.6},children:[ee," â€” Submissions & Discovery Statistics"]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[i.jsx("div",{className:"flex items-center rounded-lg overflow-hidden",style:{background:"var(--app-card)",border:"1px solid rgba(255,255,255,0.1)"},children:["week","month","year","all"].map(o=>i.jsx("button",{onClick:()=>W(o),className:"px-3 py-2 text-sm font-medium transition-colors",style:{background:c===o?"var(--app-primary)":"transparent",color:c===o?"#000":"var(--app-text)"},children:o==="all"?"All Time":o.charAt(0).toUpperCase()+o.slice(1)},o))}),i.jsx(He,{startDate:u.startDate,endDate:u.endDate,onChange:H}),t&&i.jsxs("select",{value:h,onChange:o=>y(o.target.value),className:"px-3 py-2 rounded-lg text-sm",style:{background:"var(--app-card)",border:"1px solid rgba(255,255,255,0.1)",color:"var(--app-text)"},children:[i.jsx("option",{value:"",children:"All Communities"}),f.map(o=>i.jsx("option",{value:o.tag,children:o.name},o.tag))]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[i.jsx(ae,{title:"System Submissions",value:(B.total||0).toLocaleString(),subtitle:`${B.approved||0} approved, ${B.pending||0} pending`,trend:g?.activity_trend?.map(o=>o.submissions)}),i.jsx(ae,{title:"Approval Rate",value:`${oe}%`,subtitle:B.total>0?`${B.rejected||0} rejected`:"No submissions"}),i.jsx(ae,{title:"Total Discoveries",value:(G.total||0).toLocaleString(),subtitle:`${G.unique_types||0} types discovered`,trend:g?.activity_trend?.map(o=>o.discoveries)}),i.jsx(ae,{title:"Active Members",value:((B.active_submitters||0)+(G.active_discoverers||0)).toLocaleString(),subtitle:`${B.active_submitters||0} submitters, ${G.active_discoverers||0} discoverers`})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{className:"rounded-xl p-4",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[i.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--app-text)"},children:"System Submissions Over Time"}),i.jsx(Da,{data:O,loading:s,height:280})]}),i.jsxs("div",{className:"rounded-xl p-4",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[i.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--app-text)"},children:"Discoveries Over Time"}),s?i.jsx("div",{className:"flex items-center justify-center",style:{height:280},children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2",style:{borderColor:"var(--app-primary)"}})}):Z.length===0?i.jsx("div",{className:"flex items-center justify-center",style:{height:280,color:"var(--app-text)",opacity:.5},children:"No discovery data available"}):i.jsx(ke,{width:"100%",height:280,children:i.jsxs(La,{data:Z,margin:{top:10,right:10,left:0,bottom:0},children:[i.jsx("defs",{children:i.jsxs("linearGradient",{id:"colorDiscoveries",x1:"0",y1:"0",x2:"0",y2:"1",children:[i.jsx("stop",{offset:"5%",stopColor:"#8b5cf6",stopOpacity:.3}),i.jsx("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:0})]})}),i.jsx(Ae,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),i.jsx(Ie,{dataKey:"displayDate",tick:{fill:"rgba(255,255,255,0.5)",fontSize:11},axisLine:{stroke:"rgba(255,255,255,0.1)"},tickLine:{stroke:"rgba(255,255,255,0.1)"}}),i.jsx(Pe,{tick:{fill:"rgba(255,255,255,0.5)",fontSize:11},axisLine:{stroke:"rgba(255,255,255,0.1)"},tickLine:{stroke:"rgba(255,255,255,0.1)"},allowDecimals:!1}),i.jsx(Se,{content:i.jsx(Ce,{})}),i.jsx(_a,{wrapperStyle:{paddingTop:"10px"},formatter:o=>i.jsx("span",{style:{color:"var(--app-text)",fontSize:"12px"},children:o})}),i.jsx(Ta,{type:"monotone",dataKey:"discoveries",name:"Discoveries",stroke:"#8b5cf6",strokeWidth:2,fill:"url(#colorDiscoveries)"})]})})]})]}),i.jsxs("div",{className:"rounded-xl p-4 mb-6",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[i.jsx("h2",{className:"text-lg font-semibold mb-4",style:{color:"var(--app-text)"},children:"Discovery Type Breakdown"}),s?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2",style:{borderColor:"var(--app-primary)"}})}):z.length===0?i.jsx("div",{className:"text-center py-12",style:{color:"var(--app-text)",opacity:.5},children:"No discovery data available"}):i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsx(ke,{width:"100%",height:300,children:i.jsxs(Jt,{data:z,margin:{top:10,right:10,left:0,bottom:30},children:[i.jsx(Ae,{strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),i.jsx(Ie,{dataKey:"label",tick:{fill:"rgba(255,255,255,0.5)",fontSize:11},axisLine:{stroke:"rgba(255,255,255,0.1)"},tickLine:{stroke:"rgba(255,255,255,0.1)"},angle:-35,textAnchor:"end"}),i.jsx(Pe,{tick:{fill:"rgba(255,255,255,0.5)",fontSize:11},axisLine:{stroke:"rgba(255,255,255,0.1)"},tickLine:{stroke:"rgba(255,255,255,0.1)"},allowDecimals:!1}),i.jsx(Se,{content:i.jsx(Ce,{})}),i.jsx(Ue,{dataKey:"count",name:"Discoveries",radius:[4,4,0,0],children:z.map((o,k)=>i.jsx(Te,{fill:o.fill},k))})]})}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:z.map(o=>i.jsxs("div",{className:"p-3 rounded-lg",style:{background:`${o.fill}15`,border:`1px solid ${o.fill}30`},children:[i.jsx("div",{className:"text-xl mb-1",children:o.emoji}),i.jsx("div",{className:"text-sm font-medium",style:{color:o.fill},children:o.label}),i.jsx("div",{className:"text-2xl font-bold mt-1",style:{color:"var(--app-text)"},children:o.count}),i.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--app-text)",opacity:.5},children:[o.percentage,"% of total"]})]},o.type_slug))})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"rounded-xl p-4",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--app-text)"},children:"System Submission Leaderboard"}),i.jsxs("div",{className:"text-sm",style:{color:"var(--app-text)",opacity:.6},children:["Top ",v.length]})]}),i.jsx(ea,{data:v,showCommunity:t&&!h,loading:s})]}),i.jsxs("div",{className:"rounded-xl p-4",style:{background:"linear-gradient(180deg, rgba(255,255,255,0.02), transparent)",border:"1px solid rgba(255,255,255,0.04)"},children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold",style:{color:"var(--app-text)"},children:"Discovery Leaderboard"}),i.jsxs("div",{className:"text-sm",style:{color:"var(--app-text)",opacity:.6},children:[C.total_discoveries||0," discoveries by ",C.total_discoverers||0," explorers"]})]}),s?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2",style:{borderColor:"var(--app-primary)"}})}):P.length===0?i.jsx("div",{className:"text-center py-12",style:{color:"var(--app-text)",opacity:.5},children:"No discovery data found"}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.1)"},children:[i.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium uppercase tracking-wider",style:{color:"var(--app-accent-3)"},children:"Rank"}),i.jsx("th",{className:"text-left py-3 px-4 text-xs font-medium uppercase tracking-wider",style:{color:"var(--app-accent-3)"},children:"Discoverer"}),i.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium uppercase tracking-wider",style:{color:"var(--app-accent-3)"},children:"Discoveries"}),i.jsx("th",{className:"text-right py-3 px-4 text-xs font-medium uppercase tracking-wider",style:{color:"var(--app-accent-3)"},children:"Types"})]})}),i.jsx("tbody",{children:P.map(o=>{const k=Qt[o.rank]||null;return i.jsxs("tr",{className:"transition-colors hover:bg-white/5",style:{borderBottom:"1px solid rgba(255,255,255,0.05)",...k&&{background:k.bg}},children:[i.jsx("td",{className:"py-3 px-4",children:i.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm",style:{background:k?k.bg:"rgba(255,255,255,0.05)",border:k?`2px solid ${k.border}`:"1px solid rgba(255,255,255,0.1)",color:k?k.text:"var(--app-text)"},children:o.rank})}),i.jsxs("td",{className:"py-3 px-4",children:[i.jsx("div",{className:"font-medium",style:{color:"var(--app-text)"},children:o.discoverer||"Unknown"}),o.last_discovery&&i.jsxs("div",{className:"text-xs mt-0.5",style:{color:"var(--app-text)",opacity:.5},children:["Last: ",new Date(o.last_discovery).toLocaleDateString()]})]}),i.jsx("td",{className:"py-3 px-4 text-right font-semibold",style:{color:"#8b5cf6"},children:o.total_discoveries}),i.jsx("td",{className:"py-3 px-4 text-right",children:i.jsxs("div",{className:"flex items-center justify-end gap-1 flex-wrap",children:[(o.type_slugs||[]).slice(0,5).map(L=>i.jsx("span",{title:q[L]?.label||L,className:"text-sm",children:q[L]?.emoji||L},L)),(o.type_slugs||[]).length>5&&i.jsxs("span",{className:"text-xs",style:{color:"var(--app-text)",opacity:.5},children:["+",o.type_slugs.length-5]})]})})]},o.normalized_name)})})]})})]})]})]})}export{cr as default};
